diff -rud aptitude-0.0.8.6/Makefile.am aptitude-0.0.8.6-new/Makefile.am
--- aptitude-0.0.8.6/Makefile.am	Thu Apr  5 16:49:57 2001
+++ aptitude-0.0.8.6-new/Makefile.am	Fri May 18 21:35:53 2001
@@ -9,11 +9,11 @@
 pkgdata_DATA=help.txt help-fr.txt help-gl.txt help-pl.txt
 
 install-data-local:
-	[ -d $(DESTDIR)/var/state/aptitude ] || mkdir $(DESTDIR)/var/state/aptitude
+	[ -d $(DESTDIR)/var/lib/aptitude ] || mkdir $(DESTDIR)/var/lib/aptitude
 	# FIXME: this really ought to use the autoconf directory variables
 
 uninstall-local:
-	rm -fr $(DESTDIR)/var/state/aptitude
+	rm -fr $(DESTDIR)/var/lib/aptitude
 	# Is -r a good idea here?
 
 dist-hook:
Only in aptitude-0.0.8.6-new/: Makefile.am~
diff -rud aptitude-0.0.8.6/Makefile.in aptitude-0.0.8.6-new/Makefile.in
--- aptitude-0.0.8.6/Makefile.in	Thu May  3 21:36:57 2001
+++ aptitude-0.0.8.6-new/Makefile.in	Fri May 18 21:35:53 2001
@@ -1,4 +1,4 @@
-# Makefile.in generated automatically by automake 1.4 from Makefile.am
+# Makefile.in generated automatically by automake 1.4a from Makefile.am
 
 # Copyright (C) 1994, 1995-8, 1999 Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
@@ -44,9 +44,10 @@
 AUTOHEADER = @AUTOHEADER@
 
 INSTALL = @INSTALL@
-INSTALL_PROGRAM = @INSTALL_PROGRAM@ $(AM_INSTALL_PROGRAM_FLAGS)
+INSTALL_PROGRAM = @INSTALL_PROGRAM@
 INSTALL_DATA = @INSTALL_DATA@
 INSTALL_SCRIPT = @INSTALL_SCRIPT@
+INSTALL_STRIP_FLAG =
 transform = @program_transform_name@
 
 NORMAL_INSTALL = :
@@ -104,14 +105,14 @@
 
 DISTFILES = $(DIST_COMMON) $(SOURCES) $(HEADERS) $(TEXINFOS) $(EXTRA_DIST)
 
-TAR = tar
+TAR = gtar
 GZIP_ENV = --best
 all: all-redirect
 .SUFFIXES:
 $(srcdir)/Makefile.in: Makefile.am $(top_srcdir)/configure.in $(ACLOCAL_M4) 
-	cd $(top_srcdir) && $(AUTOMAKE) --gnu --include-deps Makefile
+	cd $(top_srcdir) && $(AUTOMAKE) --gnu Makefile
 
-Makefile: $(srcdir)/Makefile.in  $(top_builddir)/config.status
+Makefile: $(srcdir)/Makefile.in  $(top_builddir)/config.status $(BUILT_SOURCES)
 	cd $(top_builddir) \
 	  && CONFIG_FILES=$@ CONFIG_HEADERS= $(SHELL) ./config.status
 
@@ -297,6 +298,11 @@
 	-rm -rf $(distdir)
 	mkdir $(distdir)
 	-chmod 777 $(distdir)
+	here=`cd $(top_builddir) && pwd`; \
+	top_distdir=`cd $(distdir) && pwd`; \
+	distdir=`cd $(distdir) && pwd`; \
+	cd $(top_srcdir) \
+	  && $(AUTOMAKE) --include-deps --build-dir=$$here --srcdir-name=$(top_srcdir) --output-dir=$$top_distdir --gnu Makefile
 	@for file in $(DISTFILES); do \
 	  d=$(srcdir); \
 	  if test -d $$d/$$file; then \
@@ -343,7 +349,7 @@
 all-am: Makefile $(DATA) config.h
 all-redirect: all-recursive-am
 install-strip:
-	$(MAKE) $(AM_MAKEFLAGS) AM_INSTALL_PROGRAM_FLAGS=-s install
+	$(MAKE) $(AM_MAKEFLAGS) INSTALL_STRIP_FLAG=-s install
 installdirs: installdirs-recursive
 installdirs-am:
 	$(mkinstalldirs)  $(DESTDIR)$(pkgdatadir)
@@ -397,11 +403,11 @@
 
 
 install-data-local:
-	[ -d $(DESTDIR)/var/state/aptitude ] || mkdir $(DESTDIR)/var/state/aptitude
+	[ -d $(DESTDIR)/var/lib/aptitude ] || mkdir $(DESTDIR)/var/lib/aptitude
 	# FIXME: this really ought to use the autoconf directory variables
 
 uninstall-local:
-	rm -fr $(DESTDIR)/var/state/aptitude
+	rm -fr $(DESTDIR)/var/lib/aptitude
 	# Is -r a good idea here?
 
 dist-hook:
Only in aptitude-0.0.8.6-new/: Makefile.in~
diff -rud aptitude-0.0.8.6/README aptitude-0.0.8.6-new/README
--- aptitude-0.0.8.6/README	Thu May  3 21:23:09 2001
+++ aptitude-0.0.8.6-new/README	Fri May 18 21:35:53 2001
@@ -654,7 +654,7 @@
 Dir::Aptitude::state
 			 Aptitude now has some persistent state information;
 			this directory holds that information.
-	default: /var/state/aptitude
+	default: /var/lib/aptitude
 
 Aptitude::Allow-ReInstall
 			 If this is set, you will be able to select
Only in aptitude-0.0.8.6-new/: README~
diff -rud aptitude-0.0.8.6/aclocal.m4 aptitude-0.0.8.6-new/aclocal.m4
--- aptitude-0.0.8.6/aclocal.m4	Thu May  3 21:29:30 2001
+++ aptitude-0.0.8.6-new/aclocal.m4	Fri May 18 21:35:53 2001
@@ -1,4 +1,4 @@
-dnl aclocal.m4 generated automatically by aclocal 1.4
+dnl aclocal.m4 generated automatically by aclocal 1.4a
 
 dnl Copyright (C) 1994, 1995-8, 1999 Free Software Foundation, Inc.
 dnl This file is free software; the Free Software Foundation
@@ -37,6 +37,8 @@
 
 AC_DEFUN(AM_INIT_AUTOMAKE,
 [AC_REQUIRE([AC_PROG_INSTALL])
+dnl We require 2.13 because we rely on SHELL being computed by configure.
+AC_PREREQ([2.13])
 PACKAGE=[$1]
 AC_SUBST(PACKAGE)
 VERSION=[$2]
@@ -381,8 +383,8 @@
    AC_REQUIRE([AC_PROG_RANLIB])dnl
    AC_REQUIRE([AC_ISC_POSIX])dnl
    AC_REQUIRE([AC_HEADER_STDC])dnl
-   AC_REQUIRE([AC_C_CONST])dnl
-   AC_REQUIRE([AC_C_INLINE])dnl
+dnl   AC_REQUIRE([AC_C_CONST])dnl
+dnl   AC_REQUIRE([AC_C_INLINE])dnl
    AC_REQUIRE([AC_TYPE_OFF_T])dnl
    AC_REQUIRE([AC_TYPE_SIZE_T])dnl
    AC_REQUIRE([AC_FUNC_ALLOCA])dnl
Only in aptitude-0.0.8.6-new/: aclocal.m4~
diff -rud aptitude-0.0.8.6/config.h.in aptitude-0.0.8.6-new/config.h.in
--- aptitude-0.0.8.6/config.h.in	Thu Apr 12 22:52:37 2001
+++ aptitude-0.0.8.6-new/config.h.in	Fri May 18 21:37:26 2001
@@ -3,9 +3,6 @@
 /* Define if using alloca.c.  */
 #undef C_ALLOCA
 
-/* Define to empty if the keyword does not work.  */
-#undef const
-
 /* Define to one of _getb67, GETB67, getb67 for Cray-2 and Cray-YMP systems.
    This function is required for alloca.c support on those systems.  */
 #undef CRAY_STACKSEG_END
@@ -19,9 +16,6 @@
 /* Define if you have a working `mmap' system call.  */
 #undef HAVE_MMAP
 
-/* Define as __inline if that's what the C compiler calls it.  */
-#undef inline
-
 /* Define to `long' if <sys/types.h> doesn't define.  */
 #undef off_t
 
@@ -175,3 +169,8 @@
 /* Define if the GNU gettext() function is already present or preinstalled. */
 #undef HAVE_GETTEXT
 
+/* Define if you have the popt library (-lpopt).  */
+#undef HAVE_LIBPOPT
+
+/* Define if you have the rpm library (-lrpm).  */
+#undef HAVE_LIBRPM
Only in aptitude-0.0.8.6-new/: config.h.in~
diff -rud aptitude-0.0.8.6/configure aptitude-0.0.8.6-new/configure
--- aptitude-0.0.8.6/configure	Thu May  3 21:29:30 2001
+++ aptitude-0.0.8.6-new/configure	Fri May 18 21:37:39 2001
@@ -695,6 +695,7 @@
 fi
 
 
+
 PACKAGE=aptitude
 
 VERSION=0.0.8.6
@@ -714,7 +715,7 @@
 
 missing_dir=`cd $ac_aux_dir && pwd`
 echo $ac_n "checking for working aclocal""... $ac_c" 1>&6
-echo "configure:718: checking for working aclocal" >&5
+echo "configure:719: checking for working aclocal" >&5
 # Run test in a subshell; some versions of sh will print an error if
 # an executable is not found, even if stderr is redirected.
 # Redirect stdin to placate older versions of autoconf.  Sigh.
@@ -727,7 +728,7 @@
 fi
 
 echo $ac_n "checking for working autoconf""... $ac_c" 1>&6
-echo "configure:731: checking for working autoconf" >&5
+echo "configure:732: checking for working autoconf" >&5
 # Run test in a subshell; some versions of sh will print an error if
 # an executable is not found, even if stderr is redirected.
 # Redirect stdin to placate older versions of autoconf.  Sigh.
@@ -740,7 +741,7 @@
 fi
 
 echo $ac_n "checking for working automake""... $ac_c" 1>&6
-echo "configure:744: checking for working automake" >&5
+echo "configure:745: checking for working automake" >&5
 # Run test in a subshell; some versions of sh will print an error if
 # an executable is not found, even if stderr is redirected.
 # Redirect stdin to placate older versions of autoconf.  Sigh.
@@ -753,7 +754,7 @@
 fi
 
 echo $ac_n "checking for working autoheader""... $ac_c" 1>&6
-echo "configure:757: checking for working autoheader" >&5
+echo "configure:758: checking for working autoheader" >&5
 # Run test in a subshell; some versions of sh will print an error if
 # an executable is not found, even if stderr is redirected.
 # Redirect stdin to placate older versions of autoconf.  Sigh.
@@ -766,7 +767,7 @@
 fi
 
 echo $ac_n "checking for working makeinfo""... $ac_c" 1>&6
-echo "configure:770: checking for working makeinfo" >&5
+echo "configure:771: checking for working makeinfo" >&5
 # Run test in a subshell; some versions of sh will print an error if
 # an executable is not found, even if stderr is redirected.
 # Redirect stdin to placate older versions of autoconf.  Sigh.
@@ -796,7 +797,7 @@
 # Extract the first word of "$ac_prog", so it can be a program name with args.
 set dummy $ac_prog; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:800: checking for $ac_word" >&5
+echo "configure:801: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_CXX'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -828,7 +829,7 @@
 
 
 echo $ac_n "checking whether the C++ compiler ($CXX $CXXFLAGS $LDFLAGS) works""... $ac_c" 1>&6
-echo "configure:832: checking whether the C++ compiler ($CXX $CXXFLAGS $LDFLAGS) works" >&5
+echo "configure:833: checking whether the C++ compiler ($CXX $CXXFLAGS $LDFLAGS) works" >&5
 
 ac_ext=C
 # CXXFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
@@ -839,12 +840,12 @@
 
 cat > conftest.$ac_ext << EOF
 
-#line 843 "configure"
+#line 844 "configure"
 #include "confdefs.h"
 
 int main(){return(0);}
 EOF
-if { (eval echo configure:848: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:849: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   ac_cv_prog_cxx_works=yes
   # If we can't run a trivial program, we are probably using a cross compiler.
   if (./conftest; exit) 2>/dev/null; then
@@ -870,12 +871,12 @@
   { echo "configure: error: installation or configuration problem: C++ compiler cannot create executables." 1>&2; exit 1; }
 fi
 echo $ac_n "checking whether the C++ compiler ($CXX $CXXFLAGS $LDFLAGS) is a cross-compiler""... $ac_c" 1>&6
-echo "configure:874: checking whether the C++ compiler ($CXX $CXXFLAGS $LDFLAGS) is a cross-compiler" >&5
+echo "configure:875: checking whether the C++ compiler ($CXX $CXXFLAGS $LDFLAGS) is a cross-compiler" >&5
 echo "$ac_t""$ac_cv_prog_cxx_cross" 1>&6
 cross_compiling=$ac_cv_prog_cxx_cross
 
 echo $ac_n "checking whether we are using GNU C++""... $ac_c" 1>&6
-echo "configure:879: checking whether we are using GNU C++" >&5
+echo "configure:880: checking whether we are using GNU C++" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_gxx'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -884,7 +885,7 @@
   yes;
 #endif
 EOF
-if { ac_try='${CXX-g++} -E conftest.C'; { (eval echo configure:888: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
+if { ac_try='${CXX-g++} -E conftest.C'; { (eval echo configure:889: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
   ac_cv_prog_gxx=yes
 else
   ac_cv_prog_gxx=no
@@ -903,7 +904,7 @@
 ac_save_CXXFLAGS="$CXXFLAGS"
 CXXFLAGS=
 echo $ac_n "checking whether ${CXX-g++} accepts -g""... $ac_c" 1>&6
-echo "configure:907: checking whether ${CXX-g++} accepts -g" >&5
+echo "configure:908: checking whether ${CXX-g++} accepts -g" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_cxx_g'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -937,7 +938,7 @@
 # Extract the first word of "ranlib", so it can be a program name with args.
 set dummy ranlib; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:941: checking for $ac_word" >&5
+echo "configure:942: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_RANLIB'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -969,7 +970,7 @@
 ac_cv_c_inline=yes
 
 echo $ac_n "checking for initscr in -lcurses""... $ac_c" 1>&6
-echo "configure:973: checking for initscr in -lcurses" >&5
+echo "configure:974: checking for initscr in -lcurses" >&5
 ac_lib_var=`echo curses'_'initscr | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -977,7 +978,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lcurses  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 981 "configure"
+#line 982 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
@@ -991,7 +992,7 @@
 initscr()
 ; return 0; }
 EOF
-if { (eval echo configure:995: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:996: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -1018,8 +1019,110 @@
   echo "$ac_t""no" 1>&6
 fi
 
+echo $ac_n "checking for poptGetArg in -lpopt""... $ac_c" 1>&6
+echo "configure:1024: checking for poptGetArg in -lpopt" >&5
+ac_lib_var=`echo popt'_'poptGetArg | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-lpopt  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 1032 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char poptGetArg();
+
+int main() {
+poptGetArg()
+; return 0; }
+EOF
+if { (eval echo configure:1046: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_lib=HAVE_LIB`echo popt | sed -e 's/[^a-zA-Z0-9_]/_/g' \
+    -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_lib 1
+EOF
+
+  LIBS="-lpopt $LIBS"
+
+else
+  echo "$ac_t""no" 1>&6
+{ echo "configure: error: Can't find the popt library -- please install popt-devel" 1>&2; exit 1; }
+fi
+
+echo $ac_n "checking for rpmdbOpen in -lrpm""... $ac_c" 1>&6
+echo "configure:1075: checking for rpmdbOpen in -lrpm" >&5
+ac_lib_var=`echo rpm'_'rpmdbOpen | sed 'y%./+-%__p_%'`
+if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  ac_save_LIBS="$LIBS"
+LIBS="-lrpm  $LIBS"
+cat > conftest.$ac_ext <<EOF
+#line 1083 "configure"
+#include "confdefs.h"
+/* Override any gcc2 internal prototype to avoid an error.  */
+#ifdef __cplusplus
+extern "C"
+#endif
+/* We use char because int might match the return type of a gcc2
+    builtin and then its argument prototype would still apply.  */
+char rpmdbOpen();
+
+int main() {
+rpmdbOpen()
+; return 0; }
+EOF
+if { (eval echo configure:1097: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=yes"
+else
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_lib_$ac_lib_var=no"
+fi
+rm -f conftest*
+LIBS="$ac_save_LIBS"
+
+fi
+if eval "test \"`echo '$ac_cv_lib_'$ac_lib_var`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+    ac_tr_lib=HAVE_LIB`echo rpm | sed -e 's/[^a-zA-Z0-9_]/_/g' \
+    -e 'y/abcdefghijklmnopqrstuvwxyz/ABCDEFGHIJKLMNOPQRSTUVWXYZ/'`
+  cat >> confdefs.h <<EOF
+#define $ac_tr_lib 1
+EOF
+
+  LIBS="-lrpm $LIBS"
+
+else
+  echo "$ac_t""no" 1>&6
+{ echo "configure: error: Can't find the RPM library -- please install rpm-devel" 1>&2; exit 1; }
+fi
+
 echo $ac_n "checking for main in -lapt-pkg""... $ac_c" 1>&6
-echo "configure:1023: checking for main in -lapt-pkg" >&5
+echo "configure:1126: checking for main in -lapt-pkg" >&5
 ac_lib_var=`echo apt-pkg'_'main | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -1027,14 +1130,14 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lapt-pkg  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 1031 "configure"
+#line 1134 "configure"
 #include "confdefs.h"
 
 int main() {
 main()
 ; return 0; }
 EOF
-if { (eval echo configure:1038: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:1141: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -1059,11 +1162,12 @@
 
 else
   echo "$ac_t""no" 1>&6
-{ echo "configure: error: Can't find the APT libraries -- please install libapt-pkg-dev" 1>&2; exit 1; }
+{ echo "configure: error: Can't find the APT libraries -- please install libapt-pkg-devel" 1>&2; exit 1; }
 fi
 
+
 echo $ac_n "checking for main in -lpthread""... $ac_c" 1>&6
-echo "configure:1067: checking for main in -lpthread" >&5
+echo "configure:1171: checking for main in -lpthread" >&5
 ac_lib_var=`echo pthread'_'main | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -1071,14 +1175,14 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lpthread  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 1075 "configure"
+#line 1179 "configure"
 #include "confdefs.h"
 
 int main() {
 main()
 ; return 0; }
 EOF
-if { (eval echo configure:1082: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:1186: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -1102,7 +1206,7 @@
 
 
 echo $ac_n "checking how to run the C++ preprocessor""... $ac_c" 1>&6
-echo "configure:1106: checking how to run the C++ preprocessor" >&5
+echo "configure:1210: checking how to run the C++ preprocessor" >&5
 if test -z "$CXXCPP"; then
 if eval "test \"`echo '$''{'ac_cv_prog_CXXCPP'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -1115,12 +1219,12 @@
 cross_compiling=$ac_cv_prog_cxx_cross
   CXXCPP="${CXX-g++} -E"
   cat > conftest.$ac_ext <<EOF
-#line 1119 "configure"
+#line 1223 "configure"
 #include "confdefs.h"
 #include <stdlib.h>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1124: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:1228: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   :
@@ -1145,12 +1249,12 @@
 echo "$ac_t""$CXXCPP" 1>&6
 
 echo $ac_n "checking for ANSI C header files""... $ac_c" 1>&6
-echo "configure:1149: checking for ANSI C header files" >&5
+echo "configure:1253: checking for ANSI C header files" >&5
 if eval "test \"`echo '$''{'ac_cv_header_stdc'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1154 "configure"
+#line 1258 "configure"
 #include "confdefs.h"
 #include <stdlib.h>
 #include <stdarg.h>
@@ -1158,7 +1262,7 @@
 #include <float.h>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1162: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:1266: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -1175,7 +1279,7 @@
 if test $ac_cv_header_stdc = yes; then
   # SunOS 4.x string.h does not declare mem*, contrary to ANSI.
 cat > conftest.$ac_ext <<EOF
-#line 1179 "configure"
+#line 1283 "configure"
 #include "confdefs.h"
 #include <string.h>
 EOF
@@ -1193,7 +1297,7 @@
 if test $ac_cv_header_stdc = yes; then
   # ISC 2.0.2 stdlib.h does not declare free, contrary to ANSI.
 cat > conftest.$ac_ext <<EOF
-#line 1197 "configure"
+#line 1301 "configure"
 #include "confdefs.h"
 #include <stdlib.h>
 EOF
@@ -1214,7 +1318,7 @@
   :
 else
   cat > conftest.$ac_ext <<EOF
-#line 1218 "configure"
+#line 1322 "configure"
 #include "confdefs.h"
 #ifdef __cplusplus
 extern "C" void exit(int);
@@ -1228,7 +1332,7 @@
 exit (0); }
 
 EOF
-if { (eval echo configure:1232: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:1336: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   :
 else
@@ -1255,17 +1359,17 @@
 do
 ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
-echo "configure:1259: checking for $ac_hdr" >&5
+echo "configure:1363: checking for $ac_hdr" >&5
 if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1264 "configure"
+#line 1368 "configure"
 #include "confdefs.h"
 #include <$ac_hdr>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1269: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:1373: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -1294,17 +1398,17 @@
 
 ac_safe=`echo "apt-pkg/init.h" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for apt-pkg/init.h""... $ac_c" 1>&6
-echo "configure:1298: checking for apt-pkg/init.h" >&5
+echo "configure:1402: checking for apt-pkg/init.h" >&5
 if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1303 "configure"
+#line 1407 "configure"
 #include "confdefs.h"
 #include <apt-pkg/init.h>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1308: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:1412: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -1326,19 +1430,53 @@
 { echo "configure: error: Can't find the APT header files -- please install libapt-pkg-dev" 1>&2; exit 1; }
 fi
 
+ac_safe=`echo "rpm/dbindex.h" | sed 'y%./+-%__p_%'`
+echo $ac_n "checking for rpm/dbindex.h""... $ac_c" 1>&6
+echo "configure:1436: checking for rpm/dbindex.h" >&5
+if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
+  echo $ac_n "(cached) $ac_c" 1>&6
+else
+  cat > conftest.$ac_ext <<EOF
+#line 1441 "configure"
+#include "confdefs.h"
+#include <rpm/dbindex.h>
+EOF
+ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
+{ (eval echo configure:1446: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
+if test -z "$ac_err"; then
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=yes"
+else
+  echo "$ac_err" >&5
+  echo "configure: failed program was:" >&5
+  cat conftest.$ac_ext >&5
+  rm -rf conftest*
+  eval "ac_cv_header_$ac_safe=no"
+fi
+rm -f conftest*
+fi
+if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
+  echo "$ac_t""yes" 1>&6
+  CXXFLAGS="$CXXFLAGS -I/usr/include/rpm" 
+else
+  echo "$ac_t""no" 1>&6
+{ echo "configure: error: Can't find the RPM header files -- please install librpm-devel" 1>&2; exit 1; }
+fi
+
 ac_safe=`echo "apt-pkg/policy.h" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for apt-pkg/policy.h""... $ac_c" 1>&6
-echo "configure:1332: checking for apt-pkg/policy.h" >&5
+echo "configure:1470: checking for apt-pkg/policy.h" >&5
 if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1337 "configure"
+#line 1475 "configure"
 #include "confdefs.h"
 #include <apt-pkg/policy.h>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1342: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:1480: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -1366,17 +1504,17 @@
 then
   ac_safe=`echo "pthread.h" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for pthread.h""... $ac_c" 1>&6
-echo "configure:1370: checking for pthread.h" >&5
+echo "configure:1508: checking for pthread.h" >&5
 if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1375 "configure"
+#line 1513 "configure"
 #include "confdefs.h"
 #include <pthread.h>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:1380: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:1518: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -1410,7 +1548,7 @@
 # Extract the first word of "gcc", so it can be a program name with args.
 set dummy gcc; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1414: checking for $ac_word" >&5
+echo "configure:1552: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1440,7 +1578,7 @@
   # Extract the first word of "cc", so it can be a program name with args.
 set dummy cc; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1444: checking for $ac_word" >&5
+echo "configure:1582: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1491,7 +1629,7 @@
       # Extract the first word of "cl", so it can be a program name with args.
 set dummy cl; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:1495: checking for $ac_word" >&5
+echo "configure:1633: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_CC'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1523,7 +1661,7 @@
 fi
 
 echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works""... $ac_c" 1>&6
-echo "configure:1527: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works" >&5
+echo "configure:1665: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) works" >&5
 
 ac_ext=c
 # CFLAGS is not in ac_cpp because -g, -O, etc. are not valid cpp options.
@@ -1534,12 +1672,12 @@
 
 cat > conftest.$ac_ext << EOF
 
-#line 1538 "configure"
+#line 1676 "configure"
 #include "confdefs.h"
 
 main(){return(0);}
 EOF
-if { (eval echo configure:1543: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:1681: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   ac_cv_prog_cc_works=yes
   # If we can't run a trivial program, we are probably using a cross compiler.
   if (./conftest; exit) 2>/dev/null; then
@@ -1565,12 +1703,12 @@
   { echo "configure: error: installation or configuration problem: C compiler cannot create executables." 1>&2; exit 1; }
 fi
 echo $ac_n "checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler""... $ac_c" 1>&6
-echo "configure:1569: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler" >&5
+echo "configure:1707: checking whether the C compiler ($CC $CFLAGS $LDFLAGS) is a cross-compiler" >&5
 echo "$ac_t""$ac_cv_prog_cc_cross" 1>&6
 cross_compiling=$ac_cv_prog_cc_cross
 
 echo $ac_n "checking whether we are using GNU C""... $ac_c" 1>&6
-echo "configure:1574: checking whether we are using GNU C" >&5
+echo "configure:1712: checking whether we are using GNU C" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_gcc'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1579,7 +1717,7 @@
   yes;
 #endif
 EOF
-if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:1583: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
+if { ac_try='${CC-cc} -E conftest.c'; { (eval echo configure:1721: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }; } | egrep yes >/dev/null 2>&1; then
   ac_cv_prog_gcc=yes
 else
   ac_cv_prog_gcc=no
@@ -1598,7 +1736,7 @@
 ac_save_CFLAGS="$CFLAGS"
 CFLAGS=
 echo $ac_n "checking whether ${CC-cc} accepts -g""... $ac_c" 1>&6
-echo "configure:1602: checking whether ${CC-cc} accepts -g" >&5
+echo "configure:1740: checking whether ${CC-cc} accepts -g" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_cc_g'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -1636,7 +1774,7 @@
 fi
 
 echo $ac_n "checking host system type""... $ac_c" 1>&6
-echo "configure:1640: checking host system type" >&5
+echo "configure:1778: checking host system type" >&5
 
 host_alias=$host
 case "$host_alias" in
@@ -1658,7 +1796,7 @@
 
 
         echo $ac_n "checking for strerror in -lcposix""... $ac_c" 1>&6
-echo "configure:1662: checking for strerror in -lcposix" >&5
+echo "configure:1800: checking for strerror in -lcposix" >&5
 ac_lib_var=`echo cposix'_'strerror | sed 'y%./+-%__p_%'`
 if eval "test \"`echo '$''{'ac_cv_lib_$ac_lib_var'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
@@ -1666,7 +1804,7 @@
   ac_save_LIBS="$LIBS"
 LIBS="-lcposix  $LIBS"
 cat > conftest.$ac_ext <<EOF
-#line 1670 "configure"
+#line 1808 "configure"
 #include "confdefs.h"
 /* Override any gcc2 internal prototype to avoid an error.  */
 #ifdef __cplusplus
@@ -1680,7 +1818,7 @@
 strerror()
 ; return 0; }
 EOF
-if { (eval echo configure:1684: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:1822: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_lib_$ac_lib_var=yes"
 else
@@ -1702,128 +1840,13 @@
 
   
 
-echo $ac_n "checking for working const""... $ac_c" 1>&6
-echo "configure:1707: checking for working const" >&5
-if eval "test \"`echo '$''{'ac_cv_c_const'+set}'`\" = set"; then
-  echo $ac_n "(cached) $ac_c" 1>&6
-else
-  cat > conftest.$ac_ext <<EOF
-#line 1712 "configure"
-#include "confdefs.h"
-
-int main() {
-
-/* Ultrix mips cc rejects this.  */
-typedef int charset[2]; const charset x;
-/* SunOS 4.1.1 cc rejects this.  */
-char const *const *ccp;
-char **p;
-/* NEC SVR4.0.2 mips cc rejects this.  */
-struct point {int x, y;};
-static struct point const zero = {0,0};
-/* AIX XL C 1.02.0.0 rejects this.
-   It does not let you subtract one const X* pointer from another in an arm
-   of an if-expression whose if-part is not a constant expression */
-const char *g = "string";
-ccp = &g + (g ? g-g : 0);
-/* HPUX 7.0 cc rejects these. */
-++ccp;
-p = (char**) ccp;
-ccp = (char const *const *) p;
-{ /* SCO 3.2v4 cc rejects this.  */
-  char *t;
-  char const *s = 0 ? (char *) 0 : (char const *) 0;
-
-  *t++ = 0;
-}
-{ /* Someone thinks the Sun supposedly-ANSI compiler will reject this.  */
-  int x[] = {25, 17};
-  const int *foo = &x[0];
-  ++foo;
-}
-{ /* Sun SC1.0 ANSI compiler rejects this -- but not the above. */
-  typedef const int *iptr;
-  iptr p = 0;
-  ++p;
-}
-{ /* AIX XL C 1.02.0.0 rejects this saying
-     "k.c", line 2.27: 1506-025 (S) Operand must be a modifiable lvalue. */
-  struct s { int j; const int *ap[3]; };
-  struct s *b; b->j = 5;
-}
-{ /* ULTRIX-32 V3.1 (Rev 9) vcc rejects this */
-  const int foo = 10;
-}
-
-; return 0; }
-EOF
-if { (eval echo configure:1761: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
-  rm -rf conftest*
-  ac_cv_c_const=yes
-else
-  echo "configure: failed program was:" >&5
-  cat conftest.$ac_ext >&5
-  rm -rf conftest*
-  ac_cv_c_const=no
-fi
-rm -f conftest*
-fi
-
-echo "$ac_t""$ac_cv_c_const" 1>&6
-if test $ac_cv_c_const = no; then
-  cat >> confdefs.h <<\EOF
-#define const 
-EOF
-
-fi
-
-echo $ac_n "checking for inline""... $ac_c" 1>&6
-echo "configure:1782: checking for inline" >&5
-if eval "test \"`echo '$''{'ac_cv_c_inline'+set}'`\" = set"; then
-  echo $ac_n "(cached) $ac_c" 1>&6
-else
-  ac_cv_c_inline=no
-for ac_kw in inline __inline__ __inline; do
-  cat > conftest.$ac_ext <<EOF
-#line 1789 "configure"
-#include "confdefs.h"
-
-int main() {
-} $ac_kw foo() {
-; return 0; }
-EOF
-if { (eval echo configure:1796: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
-  rm -rf conftest*
-  ac_cv_c_inline=$ac_kw; break
-else
-  echo "configure: failed program was:" >&5
-  cat conftest.$ac_ext >&5
-fi
-rm -f conftest*
-done
-
-fi
-
-echo "$ac_t""$ac_cv_c_inline" 1>&6
-case "$ac_cv_c_inline" in
-  inline | yes) ;;
-  no) cat >> confdefs.h <<\EOF
-#define inline 
-EOF
- ;;
-  *)  cat >> confdefs.h <<EOF
-#define inline $ac_cv_c_inline
-EOF
- ;;
-esac
-
 echo $ac_n "checking for off_t""... $ac_c" 1>&6
-echo "configure:1822: checking for off_t" >&5
+echo "configure:1845: checking for off_t" >&5
 if eval "test \"`echo '$''{'ac_cv_type_off_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1827 "configure"
+#line 1850 "configure"
 #include "confdefs.h"
 #include <sys/types.h>
 #if STDC_HEADERS
@@ -1851,12 +1874,12 @@
 fi
 
 echo $ac_n "checking for size_t""... $ac_c" 1>&6
-echo "configure:1855: checking for size_t" >&5
+echo "configure:1878: checking for size_t" >&5
 if eval "test \"`echo '$''{'ac_cv_type_size_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1860 "configure"
+#line 1883 "configure"
 #include "confdefs.h"
 #include <sys/types.h>
 #if STDC_HEADERS
@@ -1886,19 +1909,19 @@
 # The Ultrix 4.2 mips builtin alloca declared by alloca.h only works
 # for constant arguments.  Useless!
 echo $ac_n "checking for working alloca.h""... $ac_c" 1>&6
-echo "configure:1890: checking for working alloca.h" >&5
+echo "configure:1913: checking for working alloca.h" >&5
 if eval "test \"`echo '$''{'ac_cv_header_alloca_h'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1895 "configure"
+#line 1918 "configure"
 #include "confdefs.h"
 #include <alloca.h>
 int main() {
 char *p = alloca(2 * sizeof(int));
 ; return 0; }
 EOF
-if { (eval echo configure:1902: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:1925: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   ac_cv_header_alloca_h=yes
 else
@@ -1919,12 +1942,12 @@
 fi
 
 echo $ac_n "checking for alloca""... $ac_c" 1>&6
-echo "configure:1923: checking for alloca" >&5
+echo "configure:1946: checking for alloca" >&5
 if eval "test \"`echo '$''{'ac_cv_func_alloca_works'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1928 "configure"
+#line 1951 "configure"
 #include "confdefs.h"
 
 #ifdef __GNUC__
@@ -1952,7 +1975,7 @@
 char *p = (char *) alloca(1);
 ; return 0; }
 EOF
-if { (eval echo configure:1956: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:1979: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   ac_cv_func_alloca_works=yes
 else
@@ -1984,12 +2007,12 @@
 
 
 echo $ac_n "checking whether alloca needs Cray hooks""... $ac_c" 1>&6
-echo "configure:1988: checking whether alloca needs Cray hooks" >&5
+echo "configure:2011: checking whether alloca needs Cray hooks" >&5
 if eval "test \"`echo '$''{'ac_cv_os_cray'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 1993 "configure"
+#line 2016 "configure"
 #include "confdefs.h"
 #if defined(CRAY) && ! defined(CRAY2)
 webecray
@@ -2014,12 +2037,12 @@
 if test $ac_cv_os_cray = yes; then
 for ac_func in _getb67 GETB67 getb67; do
   echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:2018: checking for $ac_func" >&5
+echo "configure:2041: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2023 "configure"
+#line 2046 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -2045,7 +2068,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:2049: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2072: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -2072,7 +2095,7 @@
 fi
 
 echo $ac_n "checking stack direction for C alloca""... $ac_c" 1>&6
-echo "configure:2076: checking stack direction for C alloca" >&5
+echo "configure:2099: checking stack direction for C alloca" >&5
 if eval "test \"`echo '$''{'ac_cv_c_stack_direction'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -2080,7 +2103,7 @@
   ac_cv_c_stack_direction=0
 else
   cat > conftest.$ac_ext <<EOF
-#line 2084 "configure"
+#line 2107 "configure"
 #include "confdefs.h"
 #ifdef __cplusplus
 extern "C" void exit(int);
@@ -2102,7 +2125,7 @@
   exit (find_stack_direction() < 0);
 }
 EOF
-if { (eval echo configure:2106: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:2129: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_c_stack_direction=1
 else
@@ -2127,17 +2150,17 @@
 do
 ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
-echo "configure:2131: checking for $ac_hdr" >&5
+echo "configure:2154: checking for $ac_hdr" >&5
 if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2136 "configure"
+#line 2159 "configure"
 #include "confdefs.h"
 #include <$ac_hdr>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:2141: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:2164: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -2166,12 +2189,12 @@
 for ac_func in getpagesize
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:2170: checking for $ac_func" >&5
+echo "configure:2193: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2175 "configure"
+#line 2198 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -2197,7 +2220,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:2201: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2224: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -2222,7 +2245,7 @@
 done
 
 echo $ac_n "checking for working mmap""... $ac_c" 1>&6
-echo "configure:2226: checking for working mmap" >&5
+echo "configure:2249: checking for working mmap" >&5
 if eval "test \"`echo '$''{'ac_cv_func_mmap_fixed_mapped'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -2230,7 +2253,7 @@
   ac_cv_func_mmap_fixed_mapped=no
 else
   cat > conftest.$ac_ext <<EOF
-#line 2234 "configure"
+#line 2257 "configure"
 #include "confdefs.h"
 #ifdef __cplusplus
 extern "C" void exit(int);
@@ -2373,7 +2396,7 @@
 }
 
 EOF
-if { (eval echo configure:2377: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
+if { (eval echo configure:2400: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext} && (./conftest; exit) 2>/dev/null
 then
   ac_cv_func_mmap_fixed_mapped=yes
 else
@@ -2395,23 +2418,23 @@
 
 fi
 
-                                 
+                           
    for ac_hdr in argz.h limits.h locale.h nl_types.h malloc.h stddef.h \
 stdlib.h string.h unistd.h sys/param.h
 do
 ac_safe=`echo "$ac_hdr" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for $ac_hdr""... $ac_c" 1>&6
-echo "configure:2405: checking for $ac_hdr" >&5
+echo "configure:2428: checking for $ac_hdr" >&5
 if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2410 "configure"
+#line 2433 "configure"
 #include "confdefs.h"
 #include <$ac_hdr>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:2415: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:2438: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -2442,12 +2465,12 @@
 __argz_count __argz_stringify __argz_next
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:2446: checking for $ac_func" >&5
+echo "configure:2469: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2451 "configure"
+#line 2474 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -2473,7 +2496,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:2477: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2500: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -2500,7 +2523,7 @@
 
    
       echo $ac_n "checking for iconv""... $ac_c" 1>&6
-echo "configure:2504: checking for iconv" >&5
+echo "configure:2527: checking for iconv" >&5
 if eval "test \"`echo '$''{'am_cv_func_iconv'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -2508,7 +2531,7 @@
     am_cv_func_iconv="no, consider installing GNU libiconv"
     am_cv_lib_iconv=no
     cat > conftest.$ac_ext <<EOF
-#line 2512 "configure"
+#line 2535 "configure"
 #include "confdefs.h"
 #include <stdlib.h>
 #include <iconv.h>
@@ -2518,7 +2541,7 @@
        iconv_close(cd);
 ; return 0; }
 EOF
-if { (eval echo configure:2522: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2545: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   am_cv_func_iconv=yes
 else
@@ -2530,7 +2553,7 @@
       am_save_LIBS="$LIBS"
       LIBS="$LIBS -liconv"
       cat > conftest.$ac_ext <<EOF
-#line 2534 "configure"
+#line 2557 "configure"
 #include "confdefs.h"
 #include <stdlib.h>
 #include <iconv.h>
@@ -2540,7 +2563,7 @@
          iconv_close(cd);
 ; return 0; }
 EOF
-if { (eval echo configure:2544: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2567: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   am_cv_lib_iconv=yes
         am_cv_func_iconv=yes
@@ -2561,13 +2584,13 @@
 EOF
 
     echo $ac_n "checking for iconv declaration""... $ac_c" 1>&6
-echo "configure:2565: checking for iconv declaration" >&5
+echo "configure:2588: checking for iconv declaration" >&5
     if eval "test \"`echo '$''{'am_cv_proto_iconv'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   
       cat > conftest.$ac_ext <<EOF
-#line 2571 "configure"
+#line 2594 "configure"
 #include "confdefs.h"
 
 #include <stdlib.h>
@@ -2586,7 +2609,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:2590: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
+if { (eval echo configure:2613: \"$ac_compile\") 1>&5; (eval $ac_compile) 2>&5; }; then
   rm -rf conftest*
   am_cv_proto_iconv_arg1=""
 else
@@ -2615,19 +2638,19 @@
 
    
   echo $ac_n "checking for nl_langinfo and CODESET""... $ac_c" 1>&6
-echo "configure:2619: checking for nl_langinfo and CODESET" >&5
+echo "configure:2642: checking for nl_langinfo and CODESET" >&5
 if eval "test \"`echo '$''{'am_cv_langinfo_codeset'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2624 "configure"
+#line 2647 "configure"
 #include "confdefs.h"
 #include <langinfo.h>
 int main() {
 char* cs = nl_langinfo(CODESET);
 ; return 0; }
 EOF
-if { (eval echo configure:2631: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2654: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   am_cv_langinfo_codeset=yes
 else
@@ -2650,19 +2673,19 @@
 
    if test $ac_cv_header_locale_h = yes; then
     echo $ac_n "checking for LC_MESSAGES""... $ac_c" 1>&6
-echo "configure:2654: checking for LC_MESSAGES" >&5
+echo "configure:2677: checking for LC_MESSAGES" >&5
 if eval "test \"`echo '$''{'am_cv_val_LC_MESSAGES'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2659 "configure"
+#line 2682 "configure"
 #include "confdefs.h"
 #include <locale.h>
 int main() {
 return LC_MESSAGES
 ; return 0; }
 EOF
-if { (eval echo configure:2666: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2689: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   am_cv_val_LC_MESSAGES=yes
 else
@@ -2683,7 +2706,7 @@
     fi
   fi
    echo $ac_n "checking whether NLS is requested""... $ac_c" 1>&6
-echo "configure:2687: checking whether NLS is requested" >&5
+echo "configure:2710: checking whether NLS is requested" >&5
         # Check whether --enable-nls or --disable-nls was given.
 if test "${enable_nls+set}" = set; then
   enableval="$enable_nls"
@@ -2704,7 +2727,7 @@
 EOF
 
       echo $ac_n "checking whether included gettext is requested""... $ac_c" 1>&6
-echo "configure:2708: checking whether included gettext is requested" >&5
+echo "configure:2731: checking whether included gettext is requested" >&5
       # Check whether --with-included-gettext or --without-included-gettext was given.
 if test "${with_included_gettext+set}" = set; then
   withval="$with_included_gettext"
@@ -2724,17 +2747,17 @@
 
 	ac_safe=`echo "libintl.h" | sed 'y%./+-%__p_%'`
 echo $ac_n "checking for libintl.h""... $ac_c" 1>&6
-echo "configure:2728: checking for libintl.h" >&5
+echo "configure:2751: checking for libintl.h" >&5
 if eval "test \"`echo '$''{'ac_cv_header_$ac_safe'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2733 "configure"
+#line 2756 "configure"
 #include "confdefs.h"
 #include <libintl.h>
 EOF
 ac_try="$ac_cpp conftest.$ac_ext >/dev/null 2>conftest.out"
-{ (eval echo configure:2738: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
+{ (eval echo configure:2761: \"$ac_try\") 1>&5; (eval $ac_try) 2>&5; }
 ac_err=`grep -v '^ *+' conftest.out | grep -v "^conftest.${ac_ext}\$"`
 if test -z "$ac_err"; then
   rm -rf conftest*
@@ -2751,12 +2774,12 @@
 if eval "test \"`echo '$ac_cv_header_'$ac_safe`\" = yes"; then
   echo "$ac_t""yes" 1>&6
   echo $ac_n "checking for GNU gettext in libc""... $ac_c" 1>&6
-echo "configure:2755: checking for GNU gettext in libc" >&5
+echo "configure:2778: checking for GNU gettext in libc" >&5
 if eval "test \"`echo '$''{'gt_cv_func_gnugettext1_libc'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2760 "configure"
+#line 2783 "configure"
 #include "confdefs.h"
 #include <libintl.h>
 extern int _nl_msg_cat_cntr;
@@ -2765,7 +2788,7 @@
 return (int) gettext ("") + _nl_msg_cat_cntr
 ; return 0; }
 EOF
-if { (eval echo configure:2769: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2792: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   gt_cv_func_gnugettext1_libc=yes
 else
@@ -2781,14 +2804,14 @@
 
 	   if test "$gt_cv_func_gnugettext1_libc" != "yes"; then
 	     echo $ac_n "checking for GNU gettext in libintl""... $ac_c" 1>&6
-echo "configure:2785: checking for GNU gettext in libintl" >&5
+echo "configure:2808: checking for GNU gettext in libintl" >&5
 if eval "test \"`echo '$''{'gt_cv_func_gnugettext1_libintl'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   gt_save_LIBS="$LIBS"
 		LIBS="$LIBS -lintl"
 		cat > conftest.$ac_ext <<EOF
-#line 2792 "configure"
+#line 2815 "configure"
 #include "confdefs.h"
 #include <libintl.h>
 extern int _nl_msg_cat_cntr;
@@ -2797,7 +2820,7 @@
 return (int) gettext ("") + _nl_msg_cat_cntr
 ; return 0; }
 EOF
-if { (eval echo configure:2801: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2824: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   gt_cv_func_gnugettext1_libintl=yes
 else
@@ -2822,12 +2845,12 @@
 	     for ac_func in dcgettext
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:2826: checking for $ac_func" >&5
+echo "configure:2849: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 2831 "configure"
+#line 2854 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -2853,7 +2876,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:2857: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:2880: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
@@ -2880,7 +2903,7 @@
 	     # Extract the first word of "msgfmt", so it can be a program name with args.
 set dummy msgfmt; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:2884: checking for $ac_word" >&5
+echo "configure:2907: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_MSGFMT'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -2914,7 +2937,7 @@
 	       # Extract the first word of "gmsgfmt", so it can be a program name with args.
 set dummy gmsgfmt; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:2918: checking for $ac_word" >&5
+echo "configure:2941: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_GMSGFMT'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -2951,7 +2974,7 @@
 	     # Extract the first word of "xgettext", so it can be a program name with args.
 set dummy xgettext; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:2955: checking for $ac_word" >&5
+echo "configure:2978: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_XGETTEXT'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -3003,7 +3026,7 @@
         # Extract the first word of "msgfmt", so it can be a program name with args.
 set dummy msgfmt; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:3007: checking for $ac_word" >&5
+echo "configure:3030: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_MSGFMT'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -3037,7 +3060,7 @@
         # Extract the first word of "gmsgfmt", so it can be a program name with args.
 set dummy gmsgfmt; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:3041: checking for $ac_word" >&5
+echo "configure:3064: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_GMSGFMT'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -3073,7 +3096,7 @@
         # Extract the first word of "xgettext", so it can be a program name with args.
 set dummy xgettext; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:3077: checking for $ac_word" >&5
+echo "configure:3100: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_path_XGETTEXT'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -3139,7 +3162,7 @@
 # Extract the first word of "$ac_prog", so it can be a program name with args.
 set dummy $ac_prog; ac_word=$2
 echo $ac_n "checking for $ac_word""... $ac_c" 1>&6
-echo "configure:3143: checking for $ac_word" >&5
+echo "configure:3166: checking for $ac_word" >&5
 if eval "test \"`echo '$''{'ac_cv_prog_INTLBISON'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
@@ -3172,7 +3195,7 @@
       ac_verc_fail=yes
     else
             echo $ac_n "checking version of bison""... $ac_c" 1>&6
-echo "configure:3176: checking version of bison" >&5
+echo "configure:3199: checking version of bison" >&5
       ac_prog_version=`$INTLBISON --version 2>&1 | sed -n 's/^.*GNU Bison .* \([0-9]*\.[0-9.]*\).*$/\1/p'`
       case $ac_prog_version in
         '') ac_prog_version="v. ?.??, bad"; ac_verc_fail=yes;;
@@ -3213,7 +3236,7 @@
        LINGUAS=
      else
        echo $ac_n "checking for catalogs to be installed""... $ac_c" 1>&6
-echo "configure:3217: checking for catalogs to be installed" >&5
+echo "configure:3240: checking for catalogs to be installed" >&5
        NEW_LINGUAS=
        for presentlang in $ALL_LINGUAS; do
          useit=no
@@ -3284,12 +3307,12 @@
 
 
 echo $ac_n "checking for size_t""... $ac_c" 1>&6
-echo "configure:3288: checking for size_t" >&5
+echo "configure:3311: checking for size_t" >&5
 if eval "test \"`echo '$''{'ac_cv_type_size_t'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3293 "configure"
+#line 3316 "configure"
 #include "confdefs.h"
 #include <sys/types.h>
 #if STDC_HEADERS
@@ -3320,12 +3343,12 @@
 for ac_func in strdup
 do
 echo $ac_n "checking for $ac_func""... $ac_c" 1>&6
-echo "configure:3324: checking for $ac_func" >&5
+echo "configure:3347: checking for $ac_func" >&5
 if eval "test \"`echo '$''{'ac_cv_func_$ac_func'+set}'`\" = set"; then
   echo $ac_n "(cached) $ac_c" 1>&6
 else
   cat > conftest.$ac_ext <<EOF
-#line 3329 "configure"
+#line 3352 "configure"
 #include "confdefs.h"
 /* System header to define __stub macros and hopefully few prototypes,
     which can conflict with char $ac_func(); below.  */
@@ -3351,7 +3374,7 @@
 
 ; return 0; }
 EOF
-if { (eval echo configure:3355: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
+if { (eval echo configure:3378: \"$ac_link\") 1>&5; (eval $ac_link) 2>&5; } && test -s conftest${ac_exeext}; then
   rm -rf conftest*
   eval "ac_cv_func_$ac_func=yes"
 else
diff -rud aptitude-0.0.8.6/configure.in aptitude-0.0.8.6-new/configure.in
--- aptitude-0.0.8.6/configure.in	Thu May  3 21:29:25 2001
+++ aptitude-0.0.8.6-new/configure.in	Fri May 18 21:35:54 2001
@@ -16,7 +16,10 @@
 
 dnl Checks for libraries.
 AC_CHECK_LIB(curses, initscr)
-AC_CHECK_LIB(apt-pkg, main, , AC_MSG_ERROR([Can't find the APT libraries -- please install libapt-pkg-dev]))
+AC_CHECK_LIB(popt, poptGetArg, , AC_MSG_ERROR([Can't find the popt library -- please install popt-devel]))
+AC_CHECK_LIB(rpm, rpmdbOpen, , AC_MSG_ERROR([Can't find the RPM library -- please install rpm-devel]))
+AC_CHECK_LIB(apt-pkg, main, , AC_MSG_ERROR([Can't find the APT libraries -- please install libapt-pkg-devel]))
+
 AC_CHECK_LIB(pthread, main,
 	HAVE_LIBPTHREAD=1
 	, AC_MSG_WARN([Can't find the POSIX thread libraries -- configuring without threads]))
@@ -25,6 +28,7 @@
 AC_HEADER_STDC
 AC_CHECK_HEADERS(fcntl.h sys/ioctl.h unistd.h, , AC_MSG_ERROR([Can't find needed header file.]))
 AC_CHECK_HEADER(apt-pkg/init.h, , AC_MSG_ERROR([Can't find the APT header files -- please install libapt-pkg-dev]))
+AC_CHECK_HEADER(rpm/dbindex.h, CXXFLAGS="$CXXFLAGS -I/usr/include/rpm" , AC_MSG_ERROR([Can't find the RPM header files -- please install librpm-devel]))
 AC_CHECK_HEADER(apt-pkg/policy.h, AC_DEFINE(HAVE_LIBAPT_PKG3))
 if test x$HAVE_LIBPTHREAD = x1
 then
diff -rud aptitude-0.0.8.6/po/es_ES.po aptitude-0.0.8.6-new/po/es_ES.po
--- aptitude-0.0.8.6/po/es_ES.po	Thu May  3 21:37:01 2001
+++ aptitude-0.0.8.6-new/po/es_ES.po	Fri May 18 21:35:54 2001
@@ -469,12 +469,12 @@
 #: src/download.cc:297
 msgid ""
 "IMPORTANT: this log only lists intended actions; actions which fail due to\n"
-"dpkg problems may not be completed.\n"
+"rpm problems may not be completed.\n"
 "\n"
 msgstr ""
 "IMPORTANTE: este log slo muestra pretensin de las acciones; las acciones "
 "fallidas\n"
-"debidas a problemas dpkg no se completarn.\n"
+"debidas a problemas rpm no se completarn.\n"
 "\n"
 
 #: src/download.cc:298
Only in aptitude-0.0.8.6-new/po: es_ES.po~
diff -rud aptitude-0.0.8.6/po/pt_BR.po aptitude-0.0.8.6-new/po/pt_BR.po
--- aptitude-0.0.8.6/po/pt_BR.po	Thu May  3 21:37:01 2001
+++ aptitude-0.0.8.6-new/po/pt_BR.po	Fri May 18 21:35:54 2001
@@ -470,11 +470,11 @@
 #: src/download.cc:297
 msgid ""
 "IMPORTANT: this log only lists intended actions; actions which fail due to\n"
-"dpkg problems may not be completed.\n"
+"rpm problems may not be completed.\n"
 "\n"
 msgstr ""
 "IMPORTANTE: este registro lista somente as aes pretendidas; aes que\n"
-"falharem devido a problemas de dpkg podero no ser completadas.\n"
+"falharem devido a problemas de rpm podero no ser completadas.\n"
 "\n"
 
 #: src/download.cc:298
Only in aptitude-0.0.8.6-new/po: pt_BR.po~
diff -rud aptitude-0.0.8.6/src/Makefile.am aptitude-0.0.8.6-new/src/Makefile.am
--- aptitude-0.0.8.6/src/Makefile.am	Sat Sep 23 10:33:22 2000
+++ aptitude-0.0.8.6-new/src/Makefile.am	Fri May 18 21:35:54 2001
@@ -3,7 +3,7 @@
 SUBDIRS=generic vscreen
 
 localedir = $(datadir)/locale
-INCLUDES = -Wall -Werror -I.. -I$(srcdir) -I$(top_srcdir)/lib -I../intl
+INCLUDES = -Wall -I.. -I$(srcdir) -I$(top_srcdir)/lib -I../intl #-Werror
 DEFS = -DLOCALEDIR=\"$(localedir)\" @DEFS@
 
 bin_PROGRAMS=aptitude
diff -rud aptitude-0.0.8.6/src/Makefile.in aptitude-0.0.8.6-new/src/Makefile.in
--- aptitude-0.0.8.6/src/Makefile.in	Thu May  3 21:36:58 2001
+++ aptitude-0.0.8.6-new/src/Makefile.in	Fri May 18 21:35:54 2001
@@ -1,4 +1,4 @@
-# Makefile.in generated automatically by automake 1.4 from Makefile.am
+# Makefile.in generated automatically by automake 1.4a from Makefile.am
 
 # Copyright (C) 1994, 1995-8, 1999 Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
@@ -46,9 +46,10 @@
 AUTOHEADER = @AUTOHEADER@
 
 INSTALL = @INSTALL@
-INSTALL_PROGRAM = @INSTALL_PROGRAM@ $(AM_INSTALL_PROGRAM_FLAGS)
+INSTALL_PROGRAM = @INSTALL_PROGRAM@
 INSTALL_DATA = @INSTALL_DATA@
 INSTALL_SCRIPT = @INSTALL_SCRIPT@
+INSTALL_STRIP_FLAG =
 transform = @program_transform_name@
 
 NORMAL_INSTALL = :
@@ -88,7 +89,7 @@
 SUBDIRS = generic vscreen
 
 localedir = $(datadir)/locale
-INCLUDES = -Wall -Werror -I.. -I$(srcdir) -I$(top_srcdir)/lib -I../intl
+INCLUDES = -Wall -I.. -I$(srcdir) -I$(top_srcdir)/lib -I../intl #-Werror
 DEFS = -DLOCALEDIR=\"$(localedir)\" @DEFS@
 
 bin_PROGRAMS = aptitude
@@ -127,8 +128,16 @@
 
 DISTFILES = $(DIST_COMMON) $(SOURCES) $(HEADERS) $(TEXINFOS) $(EXTRA_DIST)
 
-TAR = tar
+TAR = gtar
 GZIP_ENV = --best
+DEP_FILES =  .deps/apt_info_tree.P .deps/apt_tree.P .deps/defaults.P \
+.deps/dep_item.P .deps/download.P .deps/download_bar.P \
+.deps/download_item.P .deps/download_screen.P .deps/load_config.P \
+.deps/main.P .deps/pkg_action_tree.P .deps/pkg_columnizer.P \
+.deps/pkg_description_treeitem.P .deps/pkg_grouppolicy.P \
+.deps/pkg_info_screen.P .deps/pkg_item.P .deps/pkg_node.P \
+.deps/pkg_subtree.P .deps/pkg_tree.P .deps/pkg_ver_item.P \
+.deps/vs_progress.P
 SOURCES = $(aptitude_SOURCES)
 OBJECTS = $(aptitude_OBJECTS)
 
@@ -136,9 +145,9 @@
 .SUFFIXES:
 .SUFFIXES: .S .c .cc .o .s
 $(srcdir)/Makefile.in: Makefile.am $(top_srcdir)/configure.in $(ACLOCAL_M4) 
-	cd $(top_srcdir) && $(AUTOMAKE) --gnu --include-deps src/Makefile
+	cd $(top_srcdir) && $(AUTOMAKE) --gnu src/Makefile
 
-Makefile: $(srcdir)/Makefile.in  $(top_builddir)/config.status
+Makefile: $(srcdir)/Makefile.in  $(top_builddir)/config.status $(BUILT_SOURCES)
 	cd $(top_builddir) \
 	  && CONFIG_FILES=$(subdir)/$@ CONFIG_HEADERS= $(SHELL) ./config.status
 
@@ -157,8 +166,8 @@
 	$(mkinstalldirs) $(DESTDIR)$(bindir)
 	@list='$(bin_PROGRAMS)'; for p in $$list; do \
 	  if test -f $$p; then \
-	    echo "  $(INSTALL_PROGRAM) $$p $(DESTDIR)$(bindir)/`echo $$p|sed 's/$(EXEEXT)$$//'|sed '$(transform)'|sed 's/$$/$(EXEEXT)/'`"; \
-	     $(INSTALL_PROGRAM) $$p $(DESTDIR)$(bindir)/`echo $$p|sed 's/$(EXEEXT)$$//'|sed '$(transform)'|sed 's/$$/$(EXEEXT)/'`; \
+	    echo "  $(INSTALL_PROGRAM) $(INSTALL_STRIP_FLAG) $$p $(DESTDIR)$(bindir)/`echo $$p|sed 's/$(EXEEXT)$$//'|sed '$(transform)'|sed 's/$$/$(EXEEXT)/'`"; \
+	     $(INSTALL_PROGRAM) $(INSTALL_STRIP_FLAG) $$p $(DESTDIR)$(bindir)/`echo $$p|sed 's/$(EXEEXT)$$//'|sed '$(transform)'|sed 's/$$/$(EXEEXT)/'`; \
 	  else :; fi; \
 	done
 
@@ -168,9 +177,6 @@
 	  rm -f $(DESTDIR)$(bindir)/`echo $$p|sed 's/$(EXEEXT)$$//'|sed '$(transform)'|sed 's/$$/$(EXEEXT)/'`; \
 	done
 
-.c.o:
-	$(COMPILE) -c $<
-
 .s.o:
 	$(COMPILE) -c $<
 
@@ -287,6 +293,11 @@
 subdir = src
 
 distdir: $(DISTFILES)
+	here=`cd $(top_builddir) && pwd`; \
+	top_distdir=`cd $(top_distdir) && pwd`; \
+	distdir=`cd $(distdir) && pwd`; \
+	cd $(top_srcdir) \
+	  && $(AUTOMAKE) --include-deps --build-dir=$$here --srcdir-name=$(top_srcdir) --output-dir=$$top_distdir --gnu src/Makefile
 	@for file in $(DISTFILES); do \
 	  d=$(srcdir); \
 	  if test -d $$d/$$file; then \
@@ -307,166 +318,57 @@
 	      || exit 1; \
 	  fi; \
 	done
-apt_info_tree.o: apt_info_tree.cc apt_info_tree.h apt_tree.h \
-	vscreen/vs_tree.h vscreen/vs_minibuf_win.h vscreen/vscreen.h \
-	vscreen/curses++.h vscreen/config/colors.h \
-	vscreen/vs_treeitem.h generic/apt.h generic/aptcache.h \
-	../config.h
-apt_tree.o: apt_tree.cc ../config.h aptitude.h apt_tree.h \
-	vscreen/vs_tree.h vscreen/vs_minibuf_win.h vscreen/vscreen.h \
-	vscreen/curses++.h vscreen/config/colors.h \
-	vscreen/vs_treeitem.h generic/apt.h generic/aptcache.h \
-	generic/undo.h vscreen/vs_pager.h vscreen/vs_statusedit.h \
-	vscreen/vs_statuschoice.h vscreen/config/keybindings.h \
-	vscreen/config/../../strhash.h vscreen/config/../curses++.h \
-	vs_progress.h pkg_action_tree.h pkg_tree.h generic/matchers.h \
-	pkg_item.h pkg_node.h pkg_columnizer.h \
-	vscreen/config/column_definition.h \
-	vscreen/config/../columnify.h pkg_grouppolicy.h download.h
-defaults.o: defaults.cc vscreen/config/keybindings.h \
-	vscreen/config/../../strhash.h vscreen/config/../curses++.h \
-	vscreen/config/colors.h apt_tree.h vscreen/vs_tree.h \
-	vscreen/vs_minibuf_win.h vscreen/vscreen.h vscreen/curses++.h \
-	vscreen/vs_treeitem.h pkg_action_tree.h pkg_tree.h \
-	generic/matchers.h pkg_node.h generic/undo.h
-dep_item.o: dep_item.cc aptitude.h ../config.h dep_item.h \
-	vscreen/vs_subtree.h vscreen/vs_treeitem.h vscreen/curses++.h \
-	vscreen/config/colors.h vscreen/vs_minibuf_win.h \
-	vscreen/vscreen.h vscreen/config/keybindings.h \
-	vscreen/config/../../strhash.h vscreen/config/../curses++.h \
-	vscreen/vs_tree.h apt_info_tree.h apt_tree.h pkg_grouppolicy.h \
-	pkg_item.h pkg_node.h generic/undo.h pkg_subtree.h \
-	pkg_item_with_subtree.h pkg_columnizer.h \
-	vscreen/config/column_definition.h \
-	vscreen/config/../columnify.h vscreen/columnify.h \
-	pkg_grouppolicy_hash.h strhash.h pkg_ver_item.h generic/apt.h \
-	generic/aptcache.h
-download.o: download.cc aptitude.h ../config.h generic/apt.h \
-	generic/aptcache.h download_screen.h vscreen/vs_tree.h \
-	vscreen/vs_minibuf_win.h vscreen/vscreen.h vscreen/curses++.h \
-	vscreen/config/colors.h vscreen/vs_treeitem.h \
-	vscreen/vs_subtree.h vscreen/config/keybindings.h \
-	vscreen/config/../../strhash.h vscreen/config/../curses++.h \
-	download_bar.h
-download_bar.o: download_bar.cc aptitude.h ../config.h download_bar.h \
-	vscreen/vs_minibuf_win.h vscreen/vscreen.h vscreen/curses++.h \
-	vscreen/config/colors.h vscreen/config/keybindings.h \
-	vscreen/config/../../strhash.h vscreen/config/../curses++.h
-download_item.o: download_item.cc aptitude.h ../config.h download_item.h \
-	vscreen/vs_treeitem.h vscreen/curses++.h \
-	vscreen/config/colors.h vscreen/vs_minibuf_win.h \
-	vscreen/vscreen.h vscreen/vs_tree.h
-download_screen.o: download_screen.cc aptitude.h ../config.h \
-	download_screen.h vscreen/vs_tree.h vscreen/vs_minibuf_win.h \
-	vscreen/vscreen.h vscreen/curses++.h vscreen/config/colors.h \
-	vscreen/vs_treeitem.h vscreen/vs_subtree.h \
-	vscreen/config/keybindings.h vscreen/config/../../strhash.h \
-	vscreen/config/../curses++.h download_item.h
-load_config.o: load_config.cc aptitude.h ../config.h \
-	vscreen/config/colors.h vscreen/config/keybindings.h \
-	vscreen/config/../../strhash.h vscreen/config/../curses++.h
-main.o: main.cc aptitude.h ../config.h vscreen/curses++.h \
-	vscreen/vscreen.h vscreen/vs_tree.h vscreen/vs_minibuf_win.h \
-	vscreen/config/colors.h vscreen/vs_treeitem.h \
-	vscreen/vs_pager.h vscreen/vs_statuschoice.h \
-	vscreen/vs_statusedit.h vs_progress.h pkg_node.h generic/undo.h \
-	pkg_action_tree.h pkg_tree.h apt_tree.h generic/matchers.h \
-	pkg_grouppolicy.h generic/apt.h generic/aptcache.h \
-	load_config.h vscreen/config/keybindings.h \
-	vscreen/config/../../strhash.h vscreen/config/../curses++.h \
-	defaults.h
-pkg_action_tree.o: pkg_action_tree.cc aptitude.h ../config.h \
-	pkg_action_tree.h pkg_tree.h apt_tree.h vscreen/vs_tree.h \
-	vscreen/vs_minibuf_win.h vscreen/vscreen.h vscreen/curses++.h \
-	vscreen/config/colors.h vscreen/vs_treeitem.h \
-	generic/matchers.h generic/apt.h generic/aptcache.h \
-	generic/undo.h vscreen/config/keybindings.h \
-	vscreen/config/../../strhash.h vscreen/config/../curses++.h
-pkg_columnizer.o: pkg_columnizer.cc aptitude.h ../config.h \
-	pkg_columnizer.h pkg_item.h pkg_node.h vscreen/vs_treeitem.h \
-	vscreen/curses++.h vscreen/config/colors.h \
-	vscreen/vs_minibuf_win.h vscreen/vscreen.h generic/undo.h \
-	vscreen/config/column_definition.h \
-	vscreen/config/../columnify.h generic/apt.h generic/aptcache.h
-pkg_description_treeitem.o: pkg_description_treeitem.cc aptitude.h \
-	../config.h pkg_description_treeitem.h vscreen/vs_treeitem.h \
-	vscreen/curses++.h vscreen/config/colors.h \
-	vscreen/vs_minibuf_win.h vscreen/vscreen.h apt_info_tree.h \
-	apt_tree.h vscreen/vs_tree.h pkg_grouppolicy.h generic/apt.h \
-	generic/aptcache.h
-pkg_grouppolicy.o: pkg_grouppolicy.cc aptitude.h ../config.h \
-	pkg_grouppolicy.h pkg_item.h pkg_node.h vscreen/vs_treeitem.h \
-	vscreen/curses++.h vscreen/config/colors.h \
-	vscreen/vs_minibuf_win.h vscreen/vscreen.h generic/undo.h \
-	pkg_subtree.h vscreen/vs_subtree.h vscreen/config/keybindings.h \
-	vscreen/config/../../strhash.h vscreen/config/../curses++.h \
-	vscreen/vs_tree.h generic/apt.h generic/aptcache.h
-pkg_info_screen.o: pkg_info_screen.cc aptitude.h ../config.h \
-	pkg_info_screen.h pkg_grouppolicy.h apt_info_tree.h apt_tree.h \
-	vscreen/vs_tree.h vscreen/vs_minibuf_win.h vscreen/vscreen.h \
-	vscreen/curses++.h vscreen/config/colors.h \
-	vscreen/vs_treeitem.h vscreen/vs_staticitem.h pkg_subtree.h \
-	vscreen/vs_subtree.h vscreen/config/keybindings.h \
-	vscreen/config/../../strhash.h vscreen/config/../curses++.h \
-	pkg_node.h generic/undo.h pkg_item_with_subtree.h pkg_item.h \
-	pkg_columnizer.h vscreen/config/column_definition.h \
-	vscreen/config/../columnify.h vscreen/columnify.h dep_item.h \
-	pkg_ver_item.h pkg_description_treeitem.h generic/apt.h \
-	generic/aptcache.h
-pkg_item.o: pkg_item.cc aptitude.h ../config.h vscreen/vs_pager.h \
-	vscreen/vs_minibuf_win.h vscreen/vscreen.h vscreen/curses++.h \
-	vscreen/config/colors.h vscreen/config/column_definition.h \
-	vscreen/config/../columnify.h dep_item.h vscreen/vs_subtree.h \
-	vscreen/vs_treeitem.h vscreen/config/keybindings.h \
-	vscreen/config/../../strhash.h vscreen/config/../curses++.h \
-	vscreen/vs_tree.h apt_info_tree.h apt_tree.h pkg_grouppolicy.h \
-	pkg_item.h pkg_node.h generic/undo.h pkg_subtree.h \
-	pkg_item_with_subtree.h pkg_columnizer.h vscreen/columnify.h \
-	download.h pkg_action_tree.h pkg_tree.h generic/matchers.h \
-	pkg_description_treeitem.h pkg_info_screen.h pkg_ver_item.h \
-	download_bar.h generic/pkg_changelog.h generic/apt.h \
-	generic/aptcache.h
-pkg_node.o: pkg_node.cc vscreen/config/keybindings.h \
-	vscreen/config/../../strhash.h vscreen/config/../curses++.h \
-	pkg_node.h vscreen/vs_treeitem.h vscreen/curses++.h \
-	vscreen/config/colors.h vscreen/vs_minibuf_win.h \
-	vscreen/vscreen.h generic/undo.h generic/apt.h \
-	generic/aptcache.h ../config.h vscreen/vs_tree.h
-pkg_subtree.o: pkg_subtree.cc pkg_subtree.h vscreen/vs_subtree.h \
-	vscreen/vs_treeitem.h vscreen/curses++.h \
-	vscreen/config/colors.h vscreen/vs_minibuf_win.h \
-	vscreen/vscreen.h vscreen/config/keybindings.h \
-	vscreen/config/../../strhash.h vscreen/config/../curses++.h \
-	vscreen/vs_tree.h pkg_node.h generic/undo.h generic/apt.h \
-	generic/aptcache.h ../config.h
-pkg_tree.o: pkg_tree.cc aptitude.h ../config.h pkg_tree.h apt_tree.h \
-	vscreen/vs_tree.h vscreen/vs_minibuf_win.h vscreen/vscreen.h \
-	vscreen/curses++.h vscreen/config/colors.h \
-	vscreen/vs_treeitem.h generic/matchers.h vs_progress.h \
-	pkg_node.h generic/undo.h pkg_item.h pkg_columnizer.h \
-	vscreen/config/column_definition.h \
-	vscreen/config/../columnify.h pkg_subtree.h \
-	vscreen/vs_subtree.h vscreen/config/keybindings.h \
-	vscreen/config/../../strhash.h vscreen/config/../curses++.h \
-	pkg_grouppolicy.h download.h vscreen/columnify.h \
-	vscreen/vs_statusedit.h generic/apt.h generic/aptcache.h
-pkg_ver_item.o: pkg_ver_item.cc aptitude.h ../config.h pkg_item.h \
-	pkg_node.h vscreen/vs_treeitem.h vscreen/curses++.h \
-	vscreen/config/colors.h vscreen/vs_minibuf_win.h \
-	vscreen/vscreen.h generic/undo.h pkg_columnizer.h \
-	vscreen/config/column_definition.h \
-	vscreen/config/../columnify.h pkg_subtree.h \
-	vscreen/vs_subtree.h vscreen/config/keybindings.h \
-	vscreen/config/../../strhash.h vscreen/config/../curses++.h \
-	vscreen/vs_tree.h pkg_ver_item.h apt_info_tree.h apt_tree.h \
-	pkg_grouppolicy.h pkg_item_with_subtree.h vscreen/columnify.h \
-	pkg_description_treeitem.h dep_item.h pkg_info_screen.h \
-	generic/apt.h generic/aptcache.h
-vs_progress.o: vs_progress.cc aptitude.h ../config.h vs_progress.h \
-	vscreen/vs_tree.h vscreen/vs_minibuf_win.h vscreen/vscreen.h \
-	vscreen/curses++.h vscreen/config/colors.h \
-	vscreen/vs_treeitem.h
 
+DEPS_MAGIC := $(shell mkdir .deps > /dev/null 2>&1 || :)
+
+-include $(DEP_FILES)
+
+mostlyclean-depend:
+
+clean-depend:
+
+distclean-depend:
+	-rm -rf .deps
+
+maintainer-clean-depend:
+
+%.o: %.c
+	@echo '$(COMPILE) -c $<'; \
+	$(COMPILE) -Wp,-MD,.deps/$(*F).pp -c $<
+	@-cp .deps/$(*F).pp .deps/$(*F).P; \
+	tr ' ' '\012' < .deps/$(*F).pp \
+	  | sed -e 's/^\\$$//' -e '/^$$/ d' -e '/:$$/ d' -e 's/$$/ :/' \
+	    >> .deps/$(*F).P; \
+	rm .deps/$(*F).pp
+
+%.lo: %.c
+	@echo '$(LTCOMPILE) -c $<'; \
+	$(LTCOMPILE) -Wp,-MD,.deps/$(*F).pp -c $<
+	@-sed -e 's/^\([^:]*\)\.o[ 	]*:/\1.lo \1.o :/' \
+	  < .deps/$(*F).pp > .deps/$(*F).P; \
+	tr ' ' '\012' < .deps/$(*F).pp \
+	  | sed -e 's/^\\$$//' -e '/^$$/ d' -e '/:$$/ d' -e 's/$$/ :/' \
+	    >> .deps/$(*F).P; \
+	rm -f .deps/$(*F).pp
+
+%.o: %.cc
+	@echo '$(CXXCOMPILE) -c $<'; \
+	$(CXXCOMPILE) -Wp,-MD,.deps/$(*F).pp -c $<
+	@-cp .deps/$(*F).pp .deps/$(*F).P; \
+	tr ' ' '\012' < .deps/$(*F).pp \
+	  | sed -e 's/^\\$$//' -e '/^$$/ d' -e '/:$$/ d' -e 's/$$/ :/' \
+	    >> .deps/$(*F).P; \
+	rm .deps/$(*F).pp
+
+%.lo: %.cc
+	@echo '$(LTCXXCOMPILE) -c $<'; \
+	$(LTCXXCOMPILE) -Wp,-MD,.deps/$(*F).pp -c $<
+	@-sed -e 's/^\([^:]*\)\.o[ 	]*:/\1.lo \1.o :/' \
+	  < .deps/$(*F).pp > .deps/$(*F).P; \
+	tr ' ' '\012' < .deps/$(*F).pp \
+	  | sed -e 's/^\\$$//' -e '/^$$/ d' -e '/:$$/ d' -e 's/$$/ :/' \
+	    >> .deps/$(*F).P; \
+	rm -f .deps/$(*F).pp
 info-am:
 info: info-recursive
 dvi-am:
@@ -489,7 +391,7 @@
 all-am: Makefile $(PROGRAMS)
 all-redirect: all-recursive
 install-strip:
-	$(MAKE) $(AM_MAKEFLAGS) AM_INSTALL_PROGRAM_FLAGS=-s install
+	$(MAKE) $(AM_MAKEFLAGS) INSTALL_STRIP_FLAG=-s install
 installdirs: installdirs-recursive
 installdirs-am:
 	$(mkinstalldirs)  $(DESTDIR)$(bindir)
@@ -506,23 +408,24 @@
 maintainer-clean-generic:
 	-test -z "$(MAINTAINERCLEANFILES)" || rm -f $(MAINTAINERCLEANFILES)
 mostlyclean-am:  mostlyclean-binPROGRAMS mostlyclean-compile \
-		mostlyclean-tags mostlyclean-generic
+		mostlyclean-tags mostlyclean-depend mostlyclean-generic
 
 mostlyclean: mostlyclean-recursive
 
-clean-am:  clean-binPROGRAMS clean-compile clean-tags clean-generic \
-		mostlyclean-am
+clean-am:  clean-binPROGRAMS clean-compile clean-tags clean-depend \
+		clean-generic mostlyclean-am
 
 clean: clean-recursive
 
 distclean-am:  distclean-binPROGRAMS distclean-compile distclean-tags \
-		distclean-generic clean-am
+		distclean-depend distclean-generic clean-am
 
 distclean: distclean-recursive
 
 maintainer-clean-am:  maintainer-clean-binPROGRAMS \
 		maintainer-clean-compile maintainer-clean-tags \
-		maintainer-clean-generic distclean-am
+		maintainer-clean-depend maintainer-clean-generic \
+		distclean-am
 	@echo "This command is intended for maintainers to use;"
 	@echo "it deletes files that may require special tools to rebuild."
 
@@ -537,12 +440,14 @@
 all-recursive check-recursive installcheck-recursive info-recursive \
 dvi-recursive mostlyclean-recursive distclean-recursive clean-recursive \
 maintainer-clean-recursive tags tags-recursive mostlyclean-tags \
-distclean-tags clean-tags maintainer-clean-tags distdir info-am info \
-dvi-am dvi check check-am installcheck-am installcheck install-exec-am \
-install-exec install-data-am install-data install-am install \
-uninstall-am uninstall all-redirect all-am all installdirs-am \
-installdirs mostlyclean-generic distclean-generic clean-generic \
-maintainer-clean-generic clean mostlyclean distclean maintainer-clean
+distclean-tags clean-tags maintainer-clean-tags distdir \
+mostlyclean-depend distclean-depend clean-depend \
+maintainer-clean-depend info-am info dvi-am dvi check check-am \
+installcheck-am installcheck install-exec-am install-exec \
+install-data-am install-data install-am install uninstall-am uninstall \
+all-redirect all-am all installdirs-am installdirs mostlyclean-generic \
+distclean-generic clean-generic maintainer-clean-generic clean \
+mostlyclean distclean maintainer-clean
 
 
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
Only in aptitude-0.0.8.6-new/src: Makefile.in~
diff -rud aptitude-0.0.8.6/src/dep_item.cc aptitude-0.0.8.6-new/src/dep_item.cc
--- aptitude-0.0.8.6/src/dep_item.cc	Sat Mar  3 16:13:56 2001
+++ aptitude-0.0.8.6-new/src/dep_item.cc	Fri May 18 21:35:54 2001
@@ -30,8 +30,11 @@
 
 #include "generic/apt.h"
 
-#include <apt-pkg/version.h>
+//#include <apt-pkg/version.h>
+#include <apt-pkg/systemfactory.h>
 #include <apt-pkg/configuration.h>
+
+#define pkgCheckDep _system->checkDep
 
 class pkg_depitem:public pkg_subtree
 {
diff -rud aptitude-0.0.8.6/src/download.cc aptitude-0.0.8.6-new/src/download.cc
--- aptitude-0.0.8.6/src/download.cc	Fri Dec 15 19:11:48 2000
+++ aptitude-0.0.8.6-new/src/download.cc	Fri May 18 21:35:54 2001
@@ -23,6 +23,7 @@
 #include <apt-pkg/error.h>
 #include <apt-pkg/dpkgpm.h>
 #include <apt-pkg/packagemanager.h>
+#include <apt-pkg/systemfactory.h>
 #include <apt-pkg/sourcelist.h>
 #include <apt-pkg/acquire.h>
 #include <apt-pkg/acquire-item.h>
@@ -213,7 +214,9 @@
     }
 
   // Make a package manager, get ready to download
-  pkgDPkgPM pm(*apt_cache_file);
+  //pkgDPkgPM pm(*apt_cache_file);
+  pkgPackageManager *pm_ = _system->CreatePackageManager(*apt_cache_file);
+  pkgPackageManager &pm = *pm_;
   if(!pm.GetArchives(&fetcher, &list, apt_package_records) || _error->PendingError())
     {
       _error->Error(_("Internal error: couldn't generate list of packages to download"));
@@ -294,7 +297,7 @@
 	}
 
       fprintf(f, "Aptitude " VERSION ": log report\n\n");
-      fprintf(f, _("IMPORTANT: this log only lists intended actions; actions which fail due to\ndpkg problems may not be completed.\n\n"));
+      fprintf(f, _("IMPORTANT: this log only lists intended actions; actions which fail due to\nrpm problems may not be completed.\n\n"));
       fprintf(f, _("Will install %li packages, and remove %li packages.\n"), (*apt_cache_file)->InstCount(), (*apt_cache_file)->DelCount());
       if((*apt_cache_file)->UsrSize()>0)
 	fprintf(f, _("%li bytes of disk space will be used\n"), (long int) (*apt_cache_file)->UsrSize());
@@ -370,7 +373,7 @@
       _error->DumpErrors();
       cerr<<_("Ack!  Something bad happened while installing packages.  Trying to recover:")<<endl;
       // and this is really a hack:
-      system("dpkg --configure -a");
+      //system("dpkg --configure -a");
       _error->Discard();
     }
 
diff -rud aptitude-0.0.8.6/src/generic/Makefile.am aptitude-0.0.8.6-new/src/generic/Makefile.am
--- aptitude-0.0.8.6/src/generic/Makefile.am	Fri Sep 22 21:35:10 2000
+++ aptitude-0.0.8.6-new/src/generic/Makefile.am	Fri May 18 21:35:54 2001
@@ -1,7 +1,7 @@
 MAINTAINERCLEANFILES=Makefile.in
 
 localedir = $(datadir)/locale
-INCLUDES = -Wall -Werror -I../../ -I$(srcdir) -I$(top_srcdir)/lib -I../../intl
+INCLUDES = -Wall -I../../ -I$(srcdir) -I$(top_srcdir)/lib -I../../intl #-Werror
 DEFS = -DLOCALEDIR=\"$(localedir)\" @DEFS@
 LDADD = @INTLLIBS@
 
diff -rud aptitude-0.0.8.6/src/generic/Makefile.in aptitude-0.0.8.6-new/src/generic/Makefile.in
--- aptitude-0.0.8.6/src/generic/Makefile.in	Thu May  3 21:36:59 2001
+++ aptitude-0.0.8.6-new/src/generic/Makefile.in	Fri May 18 21:35:54 2001
@@ -1,4 +1,4 @@
-# Makefile.in generated automatically by automake 1.4 from Makefile.am
+# Makefile.in generated automatically by automake 1.4a from Makefile.am
 
 # Copyright (C) 1994, 1995-8, 1999 Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
@@ -46,9 +46,10 @@
 AUTOHEADER = @AUTOHEADER@
 
 INSTALL = @INSTALL@
-INSTALL_PROGRAM = @INSTALL_PROGRAM@ $(AM_INSTALL_PROGRAM_FLAGS)
+INSTALL_PROGRAM = @INSTALL_PROGRAM@
 INSTALL_DATA = @INSTALL_DATA@
 INSTALL_SCRIPT = @INSTALL_SCRIPT@
+INSTALL_STRIP_FLAG =
 transform = @program_transform_name@
 
 NORMAL_INSTALL = :
@@ -86,7 +87,7 @@
 MAINTAINERCLEANFILES = Makefile.in
 
 localedir = $(datadir)/locale
-INCLUDES = -Wall -Werror -I../../ -I$(srcdir) -I$(top_srcdir)/lib -I../../intl
+INCLUDES = -Wall -I../../ -I$(srcdir) -I$(top_srcdir)/lib -I../../intl #-Werror
 DEFS = -DLOCALEDIR=\"$(localedir)\" @DEFS@
 LDADD = @INTLLIBS@
 
@@ -119,8 +120,10 @@
 
 DISTFILES = $(DIST_COMMON) $(SOURCES) $(HEADERS) $(TEXINFOS) $(EXTRA_DIST)
 
-TAR = tar
+TAR = gtar
 GZIP_ENV = --best
+DEP_FILES =  .deps/apt.P .deps/aptcache.P .deps/matchers.P \
+.deps/pkg_changelog.P .deps/undo.P
 SOURCES = $(libgeneric_a_SOURCES)
 OBJECTS = $(libgeneric_a_OBJECTS)
 
@@ -128,9 +131,9 @@
 .SUFFIXES:
 .SUFFIXES: .S .c .cc .o .s
 $(srcdir)/Makefile.in: Makefile.am $(top_srcdir)/configure.in $(ACLOCAL_M4) 
-	cd $(top_srcdir) && $(AUTOMAKE) --gnu --include-deps src/generic/Makefile
+	cd $(top_srcdir) && $(AUTOMAKE) --gnu src/generic/Makefile
 
-Makefile: $(srcdir)/Makefile.in  $(top_builddir)/config.status
+Makefile: $(srcdir)/Makefile.in  $(top_builddir)/config.status $(BUILT_SOURCES)
 	cd $(top_builddir) \
 	  && CONFIG_FILES=$(subdir)/$@ CONFIG_HEADERS= $(SHELL) ./config.status
 
@@ -144,9 +147,6 @@
 
 maintainer-clean-noinstLIBRARIES:
 
-.c.o:
-	$(COMPILE) -c $<
-
 .s.o:
 	$(COMPILE) -c $<
 
@@ -204,6 +204,11 @@
 subdir = src/generic
 
 distdir: $(DISTFILES)
+	here=`cd $(top_builddir) && pwd`; \
+	top_distdir=`cd $(top_distdir) && pwd`; \
+	distdir=`cd $(distdir) && pwd`; \
+	cd $(top_srcdir) \
+	  && $(AUTOMAKE) --include-deps --build-dir=$$here --srcdir-name=$(top_srcdir) --output-dir=$$top_distdir --gnu src/generic/Makefile
 	@for file in $(DISTFILES); do \
 	  d=$(srcdir); \
 	  if test -d $$d/$$file; then \
@@ -214,12 +219,57 @@
 	    || cp -p $$d/$$file $(distdir)/$$file || :; \
 	  fi; \
 	done
-apt.o: apt.cc apt.h aptcache.h ../../config.h undo.h
-aptcache.o: aptcache.cc ../aptitude.h ../../config.h aptcache.h undo.h
-matchers.o: matchers.cc matchers.h apt.h aptcache.h ../../config.h
-pkg_changelog.o: pkg_changelog.cc pkg_changelog.h
-undo.o: undo.cc undo.h
 
+DEPS_MAGIC := $(shell mkdir .deps > /dev/null 2>&1 || :)
+
+-include $(DEP_FILES)
+
+mostlyclean-depend:
+
+clean-depend:
+
+distclean-depend:
+	-rm -rf .deps
+
+maintainer-clean-depend:
+
+%.o: %.c
+	@echo '$(COMPILE) -c $<'; \
+	$(COMPILE) -Wp,-MD,.deps/$(*F).pp -c $<
+	@-cp .deps/$(*F).pp .deps/$(*F).P; \
+	tr ' ' '\012' < .deps/$(*F).pp \
+	  | sed -e 's/^\\$$//' -e '/^$$/ d' -e '/:$$/ d' -e 's/$$/ :/' \
+	    >> .deps/$(*F).P; \
+	rm .deps/$(*F).pp
+
+%.lo: %.c
+	@echo '$(LTCOMPILE) -c $<'; \
+	$(LTCOMPILE) -Wp,-MD,.deps/$(*F).pp -c $<
+	@-sed -e 's/^\([^:]*\)\.o[ 	]*:/\1.lo \1.o :/' \
+	  < .deps/$(*F).pp > .deps/$(*F).P; \
+	tr ' ' '\012' < .deps/$(*F).pp \
+	  | sed -e 's/^\\$$//' -e '/^$$/ d' -e '/:$$/ d' -e 's/$$/ :/' \
+	    >> .deps/$(*F).P; \
+	rm -f .deps/$(*F).pp
+
+%.o: %.cc
+	@echo '$(CXXCOMPILE) -c $<'; \
+	$(CXXCOMPILE) -Wp,-MD,.deps/$(*F).pp -c $<
+	@-cp .deps/$(*F).pp .deps/$(*F).P; \
+	tr ' ' '\012' < .deps/$(*F).pp \
+	  | sed -e 's/^\\$$//' -e '/^$$/ d' -e '/:$$/ d' -e 's/$$/ :/' \
+	    >> .deps/$(*F).P; \
+	rm .deps/$(*F).pp
+
+%.lo: %.cc
+	@echo '$(LTCXXCOMPILE) -c $<'; \
+	$(LTCXXCOMPILE) -Wp,-MD,.deps/$(*F).pp -c $<
+	@-sed -e 's/^\([^:]*\)\.o[ 	]*:/\1.lo \1.o :/' \
+	  < .deps/$(*F).pp > .deps/$(*F).P; \
+	tr ' ' '\012' < .deps/$(*F).pp \
+	  | sed -e 's/^\\$$//' -e '/^$$/ d' -e '/:$$/ d' -e 's/$$/ :/' \
+	    >> .deps/$(*F).P; \
+	rm -f .deps/$(*F).pp
 info-am:
 info: info-am
 dvi-am:
@@ -242,7 +292,7 @@
 all-am: Makefile $(LIBRARIES)
 all-redirect: all-am
 install-strip:
-	$(MAKE) $(AM_MAKEFLAGS) AM_INSTALL_PROGRAM_FLAGS=-s install
+	$(MAKE) $(AM_MAKEFLAGS) INSTALL_STRIP_FLAG=-s install
 installdirs:
 
 
@@ -257,23 +307,25 @@
 maintainer-clean-generic:
 	-test -z "$(MAINTAINERCLEANFILES)" || rm -f $(MAINTAINERCLEANFILES)
 mostlyclean-am:  mostlyclean-noinstLIBRARIES mostlyclean-compile \
-		mostlyclean-tags mostlyclean-generic
+		mostlyclean-tags mostlyclean-depend mostlyclean-generic
 
 mostlyclean: mostlyclean-am
 
-clean-am:  clean-noinstLIBRARIES clean-compile clean-tags clean-generic \
-		mostlyclean-am
+clean-am:  clean-noinstLIBRARIES clean-compile clean-tags clean-depend \
+		clean-generic mostlyclean-am
 
 clean: clean-am
 
 distclean-am:  distclean-noinstLIBRARIES distclean-compile \
-		distclean-tags distclean-generic clean-am
+		distclean-tags distclean-depend distclean-generic \
+		clean-am
 
 distclean: distclean-am
 
 maintainer-clean-am:  maintainer-clean-noinstLIBRARIES \
 		maintainer-clean-compile maintainer-clean-tags \
-		maintainer-clean-generic distclean-am
+		maintainer-clean-depend maintainer-clean-generic \
+		distclean-am
 	@echo "This command is intended for maintainers to use;"
 	@echo "it deletes files that may require special tools to rebuild."
 
@@ -283,12 +335,13 @@
 clean-noinstLIBRARIES maintainer-clean-noinstLIBRARIES \
 mostlyclean-compile distclean-compile clean-compile \
 maintainer-clean-compile tags mostlyclean-tags distclean-tags \
-clean-tags maintainer-clean-tags distdir info-am info dvi-am dvi check \
-check-am installcheck-am installcheck install-exec-am install-exec \
-install-data-am install-data install-am install uninstall-am uninstall \
-all-redirect all-am all installdirs mostlyclean-generic \
-distclean-generic clean-generic maintainer-clean-generic clean \
-mostlyclean distclean maintainer-clean
+clean-tags maintainer-clean-tags distdir mostlyclean-depend \
+distclean-depend clean-depend maintainer-clean-depend info-am info \
+dvi-am dvi check check-am installcheck-am installcheck install-exec-am \
+install-exec install-data-am install-data install-am install \
+uninstall-am uninstall all-redirect all-am all installdirs \
+mostlyclean-generic distclean-generic clean-generic \
+maintainer-clean-generic clean mostlyclean distclean maintainer-clean
 
 
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
Only in aptitude-0.0.8.6-new/src/generic: Makefile.in~
diff -rud aptitude-0.0.8.6/src/generic/aptcache.cc aptitude-0.0.8.6-new/src/generic/aptcache.cc
--- aptitude-0.0.8.6/src/generic/aptcache.cc	Thu May  3 21:11:19 2001
+++ aptitude-0.0.8.6-new/src/generic/aptcache.cc	Fri May 18 21:35:54 2001
@@ -32,6 +32,8 @@
 #ifdef HAVE_LIBAPT_PKG3
 #include <apt-pkg/pkgsystem.h>
 #include <apt-pkg/policy.h>
+#else
+#include <apt-pkg/systemfactory.h>
 #endif
 
 #include <vector>
@@ -166,7 +168,7 @@
   if(!pkgDepCache::Init(&Prog))
     return false;
 
-  string statedir=_config->FindDir("Dir::Aptitude::state", "/var/state/aptitude");
+  string statedir=_config->FindDir("Dir::Aptitude::state", "/var/lib/aptitude");
   // Should this not go under Dir:: ?  I'm not sure..
   delete package_states;
   package_states=new aptitude_state[Head().PackageCount];
@@ -298,7 +300,7 @@
 
   if(lock==-1)
     return true;
-  string statefile=_config->FindDir("Dir::Aptitude::state", "/var/state/aptitude")+"pkgstates";
+  string statefile=_config->FindDir("Dir::Aptitude::state", "/var/lib/aptitude")+"pkgstates";
 
   FileFd newstate(statefile+".new", FileFd::WriteEmpty);
   if(!newstate.IsOpen())
@@ -710,7 +712,7 @@
 bool aptitudeCacheFile::Open(OpProgress &Progress, bool WithLock)
 {
   if(WithLock)
-    Lock=new pkgDpkgLock;
+    Lock=new pkgRpmLock (false);	// pkgDpkgLock;
 
   if(_error->PendingError())
     return false;
@@ -721,7 +723,8 @@
 
   if(WithLock)
     {
-      pkgMakeStatusCache(List, Progress);
+      //pkgMakeStatusCache(List, Progress);
+      _system->makeStatusCache(List, Progress);
       if(_error->PendingError())
 	return _error->Error(_("The package lists or status file could not be parsed or opened."));
       if(!_error->empty())
@@ -737,7 +740,8 @@
     }
   else
     {
-      Map=pkgMakeStatusCacheMem(List, Progress);
+      //Map=pkgMakeStatusCacheMem(List, Progress);
+      Map=_system->makeStatusCacheMem(List, Progress);
       Progress.Done();
       if(!Map)
 	return false;
Only in aptitude-0.0.8.6-new/src/generic: aptcache.cc~
diff -rud aptitude-0.0.8.6/src/generic/aptcache.h aptitude-0.0.8.6-new/src/generic/aptcache.h
--- aptitude-0.0.8.6/src/generic/aptcache.h	Thu May  3 21:14:59 2001
+++ aptitude-0.0.8.6-new/src/generic/aptcache.h	Fri May 18 21:35:54 2001
@@ -33,7 +33,8 @@
 #include <apt-pkg/depcache.h>
 
 #ifndef HAVE_LIBAPT_PKG3
-#include <apt-pkg/dpkginit.h>
+//#include <apt-pkg/dpkginit.h>
+#include <apt-pkg/rpminit.h>
 #endif
 
 class undoable;
@@ -217,7 +218,8 @@
 {
   MMap *Map;
   aptitudeDepCache *Cache;
-  pkgDpkgLock *Lock;
+  //pkgDpkgLock *Lock;
+  pkgRpmLock *Lock;
 public:
   // We look pretty much exactly like a pointer to a dep cache
   inline operator aptitudeDepCache &() {return *Cache;};
Only in aptitude-0.0.8.6-new/src/generic: aptcache.h~
diff -rud aptitude-0.0.8.6/src/main.cc aptitude-0.0.8.6-new/src/main.cc
--- aptitude-0.0.8.6/src/main.cc	Thu Feb  1 11:20:43 2001
+++ aptitude-0.0.8.6-new/src/main.cc	Fri May 18 21:35:54 2001
@@ -43,7 +43,9 @@
 
 #include "../config.h"
 
-#include <apt-pkg/init.h>
+//#include <apt-pkg/init.h>
+#include <apt-pkg/rpmfactory.h>
+#include <apt-pkg/rpminit.h>
 
 class mypkgtree:public pkg_tree
 {
@@ -95,6 +97,11 @@
 
 int main(int argc, char *argv[])
 {
+  {
+    static RPMFactory bla;
+    static pkgRpmLock lock (false);
+  }
+
   srandom(time(0));
 
   setlocale(LC_ALL, "");
diff -rud aptitude-0.0.8.6/src/pkg_columnizer.cc aptitude-0.0.8.6-new/src/pkg_columnizer.cc
--- aptitude-0.0.8.6/src/pkg_columnizer.cc	Tue May  1 21:39:13 2001
+++ aptitude-0.0.8.6-new/src/pkg_columnizer.cc	Fri May 18 21:35:54 2001
@@ -28,9 +28,12 @@
 #include <apt-pkg/strutl.h>
 #include <apt-pkg/error.h>
 #include <apt-pkg/configuration.h>
-#include <apt-pkg/version.h>
+//#include <apt-pkg/version.h>
 #ifdef HAVE_LIBAPT_PKG3
 #include <apt-pkg/pkgsystem.h>
+#else
+#include <apt-pkg/systemfactory.h>
+#define pkgCheckDep _system->checkDep
 #endif
 
 column_definition_list *pkg_item::pkg_columnizer::columns=NULL;
diff -rud aptitude-0.0.8.6/src/pkg_info_screen.cc aptitude-0.0.8.6-new/src/pkg_info_screen.cc
--- aptitude-0.0.8.6/src/pkg_info_screen.cc	Tue Dec 19 00:37:34 2000
+++ aptitude-0.0.8.6-new/src/pkg_info_screen.cc	Fri May 18 21:35:54 2001
@@ -69,11 +69,13 @@
       tree->add_child(new pkg_description(pkg.VersionList(), _("Description")));
       tree->add_child(new vs_staticitem(_("Priority: "),ver.PriorityType()?ver.PriorityType():"Unknown"));
       tree->add_child(new vs_staticitem(_("Section: "),pkg.Section()?pkg.Section():_("Unknown")));
-      tree->add_child(new vs_staticitem(_("Maintainer: "),rec.Maintainer()));
+      //tree->add_child(new vs_staticitem(_("Maintainer: "),rec.Maintainer()));
       tree->add_child(new vs_staticitem(_("Compressed size: "), SizeToStr(ver->Size)));
       tree->add_child(new vs_staticitem(_("Uncompressed size: "), SizeToStr(ver->InstalledSize)));
+#if 0
       if(!rec.SourcePkg().empty())
 	tree->add_child(new vs_staticitem(_("Source Package: "),rec.SourcePkg()));
+#endif
 
       setup_package_deps<pkg_item_with_generic_subtree>(pkg, ver, tree);
     }
diff -rud aptitude-0.0.8.6/src/pkg_ver_item.cc aptitude-0.0.8.6-new/src/pkg_ver_item.cc
--- aptitude-0.0.8.6/src/pkg_ver_item.cc	Thu May  3 21:02:37 2001
+++ aptitude-0.0.8.6-new/src/pkg_ver_item.cc	Fri May 18 21:35:54 2001
@@ -36,6 +36,8 @@
 #include <apt-pkg/configuration.h>
 #include <apt-pkg/strutl.h>
 
+#define pkgCheckDep _system->checkDep
+
 class pkg_ver_columnizer:public column_generator
 {
   pkgCache::VerIterator ver;
diff -rud aptitude-0.0.8.6/src/pkg_ver_item.h aptitude-0.0.8.6-new/src/pkg_ver_item.h
--- aptitude-0.0.8.6/src/pkg_ver_item.h	Sat Mar  3 16:14:59 2001
+++ aptitude-0.0.8.6-new/src/pkg_ver_item.h	Fri May 18 21:35:54 2001
@@ -28,10 +28,13 @@
 #include "pkg_grouppolicy.h"
 #include "pkg_item_with_subtree.h"
 
-#include <apt-pkg/version.h>
+//#include <apt-pkg/version.h>
 #include <apt-pkg/depcache.h>
 #ifdef HAVE_LIBAPT_PKG3
 #include <apt-pkg/pkgsystem.h>
+#else
+#include <apt-pkg/systemfactory.h>
+#define pkgVersionCompare _system->versionCompare
 #endif
 
 class pkg_ver_item:public pkg_tree_node
diff -rud aptitude-0.0.8.6/src/vscreen/Makefile.in aptitude-0.0.8.6-new/src/vscreen/Makefile.in
--- aptitude-0.0.8.6/src/vscreen/Makefile.in	Thu May  3 21:37:00 2001
+++ aptitude-0.0.8.6-new/src/vscreen/Makefile.in	Fri May 18 21:35:54 2001
@@ -1,4 +1,4 @@
-# Makefile.in generated automatically by automake 1.4 from Makefile.am
+# Makefile.in generated automatically by automake 1.4a from Makefile.am
 
 # Copyright (C) 1994, 1995-8, 1999 Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
@@ -46,9 +46,10 @@
 AUTOHEADER = @AUTOHEADER@
 
 INSTALL = @INSTALL@
-INSTALL_PROGRAM = @INSTALL_PROGRAM@ $(AM_INSTALL_PROGRAM_FLAGS)
+INSTALL_PROGRAM = @INSTALL_PROGRAM@
 INSTALL_DATA = @INSTALL_DATA@
 INSTALL_SCRIPT = @INSTALL_SCRIPT@
+INSTALL_STRIP_FLAG =
 transform = @program_transform_name@
 
 NORMAL_INSTALL = :
@@ -122,8 +123,12 @@
 
 DISTFILES = $(DIST_COMMON) $(SOURCES) $(HEADERS) $(TEXINFOS) $(EXTRA_DIST)
 
-TAR = tar
+TAR = gtar
 GZIP_ENV = --best
+DEP_FILES =  .deps/columnify.P .deps/curses++.P .deps/vs_minibuf_win.P \
+.deps/vs_pager.P .deps/vs_staticitem.P .deps/vs_statuschoice.P \
+.deps/vs_statusedit.P .deps/vs_tree.P .deps/vs_treeitem.P \
+.deps/vscreen.P
 SOURCES = $(libvscreen_a_SOURCES)
 OBJECTS = $(libvscreen_a_OBJECTS)
 
@@ -131,9 +136,9 @@
 .SUFFIXES:
 .SUFFIXES: .S .c .cc .o .s
 $(srcdir)/Makefile.in: Makefile.am $(top_srcdir)/configure.in $(ACLOCAL_M4) 
-	cd $(top_srcdir) && $(AUTOMAKE) --gnu --include-deps src/vscreen/Makefile
+	cd $(top_srcdir) && $(AUTOMAKE) --gnu src/vscreen/Makefile
 
-Makefile: $(srcdir)/Makefile.in  $(top_builddir)/config.status
+Makefile: $(srcdir)/Makefile.in  $(top_builddir)/config.status $(BUILT_SOURCES)
 	cd $(top_builddir) \
 	  && CONFIG_FILES=$(subdir)/$@ CONFIG_HEADERS= $(SHELL) ./config.status
 
@@ -147,9 +152,6 @@
 
 maintainer-clean-noinstLIBRARIES:
 
-.c.o:
-	$(COMPILE) -c $<
-
 .s.o:
 	$(COMPILE) -c $<
 
@@ -267,6 +269,11 @@
 subdir = src/vscreen
 
 distdir: $(DISTFILES)
+	here=`cd $(top_builddir) && pwd`; \
+	top_distdir=`cd $(top_distdir) && pwd`; \
+	distdir=`cd $(distdir) && pwd`; \
+	cd $(top_srcdir) \
+	  && $(AUTOMAKE) --include-deps --build-dir=$$here --srcdir-name=$(top_srcdir) --output-dir=$$top_distdir --gnu src/vscreen/Makefile
 	@for file in $(DISTFILES); do \
 	  d=$(srcdir); \
 	  if test -d $$d/$$file; then \
@@ -287,32 +294,57 @@
 	      || exit 1; \
 	  fi; \
 	done
-columnify.o: columnify.cc columnify.h
-curses++.o: curses++.cc curses++.h
-vs_minibuf_win.o: vs_minibuf_win.cc vs_minibuf_win.h vscreen.h \
-	curses++.h config/colors.h
-vs_pager.o: vs_pager.cc vs_pager.h vs_minibuf_win.h vscreen.h curses++.h \
-	config/colors.h vs_statusedit.h config/keybindings.h \
-	config/../../strhash.h config/../curses++.h
-vs_staticitem.o: vs_staticitem.cc vs_staticitem.h vs_treeitem.h \
-	curses++.h config/colors.h vs_minibuf_win.h vscreen.h vs_tree.h
-vs_statuschoice.o: vs_statuschoice.cc vs_statuschoice.h vs_minibuf_win.h \
-	vscreen.h curses++.h config/colors.h config/keybindings.h \
-	config/../../strhash.h config/../curses++.h
-vs_statusedit.o: vs_statusedit.cc vs_statusedit.h vs_minibuf_win.h \
-	vscreen.h curses++.h config/colors.h config/keybindings.h \
-	config/../../strhash.h config/../curses++.h
-vs_tree.o: vs_tree.cc vs_tree.h vs_minibuf_win.h vscreen.h curses++.h \
-	config/colors.h vs_treeitem.h vs_statusedit.h \
-	config/keybindings.h config/../../strhash.h \
-	config/../curses++.h
-vs_treeitem.o: vs_treeitem.cc vs_treeitem.h curses++.h config/colors.h \
-	vs_minibuf_win.h vscreen.h vs_tree.h
-vscreen.o: vscreen.cc vscreen.h curses++.h config/keybindings.h \
-	config/../../strhash.h config/../curses++.h config/colors.h \
-	vs_tree.h vs_minibuf_win.h vs_treeitem.h vs_statusedit.h \
-	vs_statuschoice.h vs_pager.h
 
+DEPS_MAGIC := $(shell mkdir .deps > /dev/null 2>&1 || :)
+
+-include $(DEP_FILES)
+
+mostlyclean-depend:
+
+clean-depend:
+
+distclean-depend:
+	-rm -rf .deps
+
+maintainer-clean-depend:
+
+%.o: %.c
+	@echo '$(COMPILE) -c $<'; \
+	$(COMPILE) -Wp,-MD,.deps/$(*F).pp -c $<
+	@-cp .deps/$(*F).pp .deps/$(*F).P; \
+	tr ' ' '\012' < .deps/$(*F).pp \
+	  | sed -e 's/^\\$$//' -e '/^$$/ d' -e '/:$$/ d' -e 's/$$/ :/' \
+	    >> .deps/$(*F).P; \
+	rm .deps/$(*F).pp
+
+%.lo: %.c
+	@echo '$(LTCOMPILE) -c $<'; \
+	$(LTCOMPILE) -Wp,-MD,.deps/$(*F).pp -c $<
+	@-sed -e 's/^\([^:]*\)\.o[ 	]*:/\1.lo \1.o :/' \
+	  < .deps/$(*F).pp > .deps/$(*F).P; \
+	tr ' ' '\012' < .deps/$(*F).pp \
+	  | sed -e 's/^\\$$//' -e '/^$$/ d' -e '/:$$/ d' -e 's/$$/ :/' \
+	    >> .deps/$(*F).P; \
+	rm -f .deps/$(*F).pp
+
+%.o: %.cc
+	@echo '$(CXXCOMPILE) -c $<'; \
+	$(CXXCOMPILE) -Wp,-MD,.deps/$(*F).pp -c $<
+	@-cp .deps/$(*F).pp .deps/$(*F).P; \
+	tr ' ' '\012' < .deps/$(*F).pp \
+	  | sed -e 's/^\\$$//' -e '/^$$/ d' -e '/:$$/ d' -e 's/$$/ :/' \
+	    >> .deps/$(*F).P; \
+	rm .deps/$(*F).pp
+
+%.lo: %.cc
+	@echo '$(LTCXXCOMPILE) -c $<'; \
+	$(LTCXXCOMPILE) -Wp,-MD,.deps/$(*F).pp -c $<
+	@-sed -e 's/^\([^:]*\)\.o[ 	]*:/\1.lo \1.o :/' \
+	  < .deps/$(*F).pp > .deps/$(*F).P; \
+	tr ' ' '\012' < .deps/$(*F).pp \
+	  | sed -e 's/^\\$$//' -e '/^$$/ d' -e '/:$$/ d' -e 's/$$/ :/' \
+	    >> .deps/$(*F).P; \
+	rm -f .deps/$(*F).pp
 info-am:
 info: info-recursive
 dvi-am:
@@ -335,7 +367,7 @@
 all-am: Makefile $(LIBRARIES)
 all-redirect: all-recursive
 install-strip:
-	$(MAKE) $(AM_MAKEFLAGS) AM_INSTALL_PROGRAM_FLAGS=-s install
+	$(MAKE) $(AM_MAKEFLAGS) INSTALL_STRIP_FLAG=-s install
 installdirs: installdirs-recursive
 installdirs-am:
 
@@ -351,23 +383,25 @@
 maintainer-clean-generic:
 	-test -z "$(MAINTAINERCLEANFILES)" || rm -f $(MAINTAINERCLEANFILES)
 mostlyclean-am:  mostlyclean-noinstLIBRARIES mostlyclean-compile \
-		mostlyclean-tags mostlyclean-generic
+		mostlyclean-tags mostlyclean-depend mostlyclean-generic
 
 mostlyclean: mostlyclean-recursive
 
-clean-am:  clean-noinstLIBRARIES clean-compile clean-tags clean-generic \
-		mostlyclean-am
+clean-am:  clean-noinstLIBRARIES clean-compile clean-tags clean-depend \
+		clean-generic mostlyclean-am
 
 clean: clean-recursive
 
 distclean-am:  distclean-noinstLIBRARIES distclean-compile \
-		distclean-tags distclean-generic clean-am
+		distclean-tags distclean-depend distclean-generic \
+		clean-am
 
 distclean: distclean-recursive
 
 maintainer-clean-am:  maintainer-clean-noinstLIBRARIES \
 		maintainer-clean-compile maintainer-clean-tags \
-		maintainer-clean-generic distclean-am
+		maintainer-clean-depend maintainer-clean-generic \
+		distclean-am
 	@echo "This command is intended for maintainers to use;"
 	@echo "it deletes files that may require special tools to rebuild."
 
@@ -382,12 +416,14 @@
 all-recursive check-recursive installcheck-recursive info-recursive \
 dvi-recursive mostlyclean-recursive distclean-recursive clean-recursive \
 maintainer-clean-recursive tags tags-recursive mostlyclean-tags \
-distclean-tags clean-tags maintainer-clean-tags distdir info-am info \
-dvi-am dvi check check-am installcheck-am installcheck install-exec-am \
-install-exec install-data-am install-data install-am install \
-uninstall-am uninstall all-redirect all-am all installdirs-am \
-installdirs mostlyclean-generic distclean-generic clean-generic \
-maintainer-clean-generic clean mostlyclean distclean maintainer-clean
+distclean-tags clean-tags maintainer-clean-tags distdir \
+mostlyclean-depend distclean-depend clean-depend \
+maintainer-clean-depend info-am info dvi-am dvi check check-am \
+installcheck-am installcheck install-exec-am install-exec \
+install-data-am install-data install-am install uninstall-am uninstall \
+all-redirect all-am all installdirs-am installdirs mostlyclean-generic \
+distclean-generic clean-generic maintainer-clean-generic clean \
+mostlyclean distclean maintainer-clean
 
 
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
Only in aptitude-0.0.8.6-new/src/vscreen: Makefile.in~
diff -rud aptitude-0.0.8.6/src/vscreen/config/Makefile.in aptitude-0.0.8.6-new/src/vscreen/config/Makefile.in
--- aptitude-0.0.8.6/src/vscreen/config/Makefile.in	Thu May  3 21:37:01 2001
+++ aptitude-0.0.8.6-new/src/vscreen/config/Makefile.in	Fri May 18 21:35:54 2001
@@ -1,4 +1,4 @@
-# Makefile.in generated automatically by automake 1.4 from Makefile.am
+# Makefile.in generated automatically by automake 1.4a from Makefile.am
 
 # Copyright (C) 1994, 1995-8, 1999 Free Software Foundation, Inc.
 # This Makefile.in is free software; the Free Software Foundation
@@ -46,9 +46,10 @@
 AUTOHEADER = @AUTOHEADER@
 
 INSTALL = @INSTALL@
-INSTALL_PROGRAM = @INSTALL_PROGRAM@ $(AM_INSTALL_PROGRAM_FLAGS)
+INSTALL_PROGRAM = @INSTALL_PROGRAM@
 INSTALL_DATA = @INSTALL_DATA@
 INSTALL_SCRIPT = @INSTALL_SCRIPT@
+INSTALL_STRIP_FLAG =
 transform = @program_transform_name@
 
 NORMAL_INSTALL = :
@@ -118,8 +119,10 @@
 
 DISTFILES = $(DIST_COMMON) $(SOURCES) $(HEADERS) $(TEXINFOS) $(EXTRA_DIST)
 
-TAR = tar
+TAR = gtar
 GZIP_ENV = --best
+DEP_FILES =  .deps/colors.P .deps/column_definition.P \
+.deps/keybindings.P
 SOURCES = $(libconf_a_SOURCES)
 OBJECTS = $(libconf_a_OBJECTS)
 
@@ -127,9 +130,9 @@
 .SUFFIXES:
 .SUFFIXES: .S .c .cc .o .s
 $(srcdir)/Makefile.in: Makefile.am $(top_srcdir)/configure.in $(ACLOCAL_M4) 
-	cd $(top_srcdir) && $(AUTOMAKE) --gnu --include-deps src/vscreen/config/Makefile
+	cd $(top_srcdir) && $(AUTOMAKE) --gnu src/vscreen/config/Makefile
 
-Makefile: $(srcdir)/Makefile.in  $(top_builddir)/config.status
+Makefile: $(srcdir)/Makefile.in  $(top_builddir)/config.status $(BUILT_SOURCES)
 	cd $(top_builddir) \
 	  && CONFIG_FILES=$(subdir)/$@ CONFIG_HEADERS= $(SHELL) ./config.status
 
@@ -143,9 +146,6 @@
 
 maintainer-clean-noinstLIBRARIES:
 
-.c.o:
-	$(COMPILE) -c $<
-
 .s.o:
 	$(COMPILE) -c $<
 
@@ -203,6 +203,11 @@
 subdir = src/vscreen/config
 
 distdir: $(DISTFILES)
+	here=`cd $(top_builddir) && pwd`; \
+	top_distdir=`cd $(top_distdir) && pwd`; \
+	distdir=`cd $(distdir) && pwd`; \
+	cd $(top_srcdir) \
+	  && $(AUTOMAKE) --include-deps --build-dir=$$here --srcdir-name=$(top_srcdir) --output-dir=$$top_distdir --gnu src/vscreen/config/Makefile
 	@for file in $(DISTFILES); do \
 	  d=$(srcdir); \
 	  if test -d $$d/$$file; then \
@@ -213,12 +218,57 @@
 	    || cp -p $$d/$$file $(distdir)/$$file || :; \
 	  fi; \
 	done
-colors.o: colors.cc colors.h ../vscreen.h ../curses++.h ../../strhash.h
-column_definition.o: column_definition.cc column_definition.h \
-	../columnify.h
-keybindings.o: keybindings.cc keybindings.h ../../strhash.h \
-	../curses++.h ../../../config.h
 
+DEPS_MAGIC := $(shell mkdir .deps > /dev/null 2>&1 || :)
+
+-include $(DEP_FILES)
+
+mostlyclean-depend:
+
+clean-depend:
+
+distclean-depend:
+	-rm -rf .deps
+
+maintainer-clean-depend:
+
+%.o: %.c
+	@echo '$(COMPILE) -c $<'; \
+	$(COMPILE) -Wp,-MD,.deps/$(*F).pp -c $<
+	@-cp .deps/$(*F).pp .deps/$(*F).P; \
+	tr ' ' '\012' < .deps/$(*F).pp \
+	  | sed -e 's/^\\$$//' -e '/^$$/ d' -e '/:$$/ d' -e 's/$$/ :/' \
+	    >> .deps/$(*F).P; \
+	rm .deps/$(*F).pp
+
+%.lo: %.c
+	@echo '$(LTCOMPILE) -c $<'; \
+	$(LTCOMPILE) -Wp,-MD,.deps/$(*F).pp -c $<
+	@-sed -e 's/^\([^:]*\)\.o[ 	]*:/\1.lo \1.o :/' \
+	  < .deps/$(*F).pp > .deps/$(*F).P; \
+	tr ' ' '\012' < .deps/$(*F).pp \
+	  | sed -e 's/^\\$$//' -e '/^$$/ d' -e '/:$$/ d' -e 's/$$/ :/' \
+	    >> .deps/$(*F).P; \
+	rm -f .deps/$(*F).pp
+
+%.o: %.cc
+	@echo '$(CXXCOMPILE) -c $<'; \
+	$(CXXCOMPILE) -Wp,-MD,.deps/$(*F).pp -c $<
+	@-cp .deps/$(*F).pp .deps/$(*F).P; \
+	tr ' ' '\012' < .deps/$(*F).pp \
+	  | sed -e 's/^\\$$//' -e '/^$$/ d' -e '/:$$/ d' -e 's/$$/ :/' \
+	    >> .deps/$(*F).P; \
+	rm .deps/$(*F).pp
+
+%.lo: %.cc
+	@echo '$(LTCXXCOMPILE) -c $<'; \
+	$(LTCXXCOMPILE) -Wp,-MD,.deps/$(*F).pp -c $<
+	@-sed -e 's/^\([^:]*\)\.o[ 	]*:/\1.lo \1.o :/' \
+	  < .deps/$(*F).pp > .deps/$(*F).P; \
+	tr ' ' '\012' < .deps/$(*F).pp \
+	  | sed -e 's/^\\$$//' -e '/^$$/ d' -e '/:$$/ d' -e 's/$$/ :/' \
+	    >> .deps/$(*F).P; \
+	rm -f .deps/$(*F).pp
 info-am:
 info: info-am
 dvi-am:
@@ -241,7 +291,7 @@
 all-am: Makefile $(LIBRARIES)
 all-redirect: all-am
 install-strip:
-	$(MAKE) $(AM_MAKEFLAGS) AM_INSTALL_PROGRAM_FLAGS=-s install
+	$(MAKE) $(AM_MAKEFLAGS) INSTALL_STRIP_FLAG=-s install
 installdirs:
 
 
@@ -256,23 +306,25 @@
 maintainer-clean-generic:
 	-test -z "$(MAINTAINERCLEANFILES)" || rm -f $(MAINTAINERCLEANFILES)
 mostlyclean-am:  mostlyclean-noinstLIBRARIES mostlyclean-compile \
-		mostlyclean-tags mostlyclean-generic
+		mostlyclean-tags mostlyclean-depend mostlyclean-generic
 
 mostlyclean: mostlyclean-am
 
-clean-am:  clean-noinstLIBRARIES clean-compile clean-tags clean-generic \
-		mostlyclean-am
+clean-am:  clean-noinstLIBRARIES clean-compile clean-tags clean-depend \
+		clean-generic mostlyclean-am
 
 clean: clean-am
 
 distclean-am:  distclean-noinstLIBRARIES distclean-compile \
-		distclean-tags distclean-generic clean-am
+		distclean-tags distclean-depend distclean-generic \
+		clean-am
 
 distclean: distclean-am
 
 maintainer-clean-am:  maintainer-clean-noinstLIBRARIES \
 		maintainer-clean-compile maintainer-clean-tags \
-		maintainer-clean-generic distclean-am
+		maintainer-clean-depend maintainer-clean-generic \
+		distclean-am
 	@echo "This command is intended for maintainers to use;"
 	@echo "it deletes files that may require special tools to rebuild."
 
@@ -282,12 +334,13 @@
 clean-noinstLIBRARIES maintainer-clean-noinstLIBRARIES \
 mostlyclean-compile distclean-compile clean-compile \
 maintainer-clean-compile tags mostlyclean-tags distclean-tags \
-clean-tags maintainer-clean-tags distdir info-am info dvi-am dvi check \
-check-am installcheck-am installcheck install-exec-am install-exec \
-install-data-am install-data install-am install uninstall-am uninstall \
-all-redirect all-am all installdirs mostlyclean-generic \
-distclean-generic clean-generic maintainer-clean-generic clean \
-mostlyclean distclean maintainer-clean
+clean-tags maintainer-clean-tags distdir mostlyclean-depend \
+distclean-depend clean-depend maintainer-clean-depend info-am info \
+dvi-am dvi check check-am installcheck-am installcheck install-exec-am \
+install-exec install-data-am install-data install-am install \
+uninstall-am uninstall all-redirect all-am all installdirs \
+mostlyclean-generic distclean-generic clean-generic \
+maintainer-clean-generic clean mostlyclean distclean maintainer-clean
 
 
 # Tell versions [3.59,3.63) of GNU make to not export all variables.
Only in aptitude-0.0.8.6-new/src/vscreen/config: Makefile.in~
